class t{constructor(t){this.data=t}getResult(){return Boolean(this.data.result)}getTransactionId(){return void 0!==this.data.transaction&&void 0!==this.data.transaction.transactionId?this.data.transaction.transactionId:null}getThreeDSTransactionId(){return void 0===this.data.transactionID?null:this.data.transactionID}getTdsApiUrlStatus(){return void 0===this.data.tdsApiURLStatus?null:this.data.tdsApiURLStatus}}class e extends t{constructor(t){super(t)}getNextAction(){return this.data.nextAction}}class n{constructor(t,e={}){this.subject=t,this.parameters=e,this.propagationStopped=!1}getSubject(){return this.subject}getParameter(t){if(this.hasParameter(t))return this.parameters[t];throw new Error('Parameter "'+t+'" was not found.')}setParameter(t,e){return this.parameters[t]=e,this}setParameters(t){return this.parameters=t,this}getParameters(){return this.parameters}hasParameter(t){return t in this.parameters}isPropagationStopped(){return this.propagationStopped}stopPropagation(){this.propagationStopped=!0}}class r extends n{}class i{static get form(){return"form"}static get creditCardImage(){return"creditCardImage"}static get tdsMethodPlaceholderId(){return"payment_tds_method_placeholder"}static get creditCardHolder(){return"creditCardHolder"}static get creditCardNumber(){return"creditCardNumber"}static get creditCardCvv(){return"creditCardCvv"}static get creditCardCvvLabel(){return"creditCardCvvLabel"}static get creditCardExpiration(){return"creditCardExpiration"}static get creditCardExpirationMonth(){return"creditCardExpirationMonth"}static get creditCardExpirationYear(){return"creditCardExpirationYear"}static get submitButton(){return"submitButton"}static get modalContainer(){return"modalContainer"}}class s{constructor(t){this.config=t,this.references={},this.lookup={};let e=this;this.lookup[i.form]=function(){return document.querySelector("form["+e.config.form_selector+"]")},this.lookup[i.creditCardImage]=function(){return e.getElementByQuerySelector("img[data-credit-card-type]")},this.lookup[i.creditCardHolder]=function(){return e.getElementByQuerySelector('[name="cardholder"]')},this.lookup[i.creditCardNumber]=function(){return e.getElementByQuerySelector('[name="cardnumber"]')},this.lookup[i.creditCardCvv]=function(){return e.getElementByQuerySelector('[name="cardcvc"]')},this.lookup[i.creditCardCvvLabel]=function(){return e.getElementByQuerySelector("[data-cvc-label]")},this.lookup[i.creditCardExpiration]=function(){return e.getElementByQuerySelector('[name="expiration"]')},this.lookup[i.creditCardExpirationMonth]=function(){return e.getElementByQuerySelector('[name="valid_thru_month"]')},this.lookup[i.creditCardExpirationYear]=function(){return e.getElementByQuerySelector('[name="valid_thru_year"]')},this.lookup[i.submitButton]=function(){return e.getElementByQuerySelector('[type="submit"]')},this.lookup[i.modalContainer]=function(){return document.getElementById("payment-modal")},this.lookup[i.tdsMethodPlaceholderId]=function(){return document.getElementById(i.tdsMethodPlaceholderId)}}getReference(t){if(!(t in this.references)&&!(t in this.lookup))throw new Error("Unknown element reference.");return void 0!==this.references[t]||(this.references[t]=this.lookup[t]()),this.references[t]}getElementByQuerySelector(t){return this.getReference(i.form).querySelector(t)}}class a{constructor(){this.state={loading:!1,inputComplete:!1,cardHolderInputComplete:!1,cardNumberInputComplete:!1,cardCvvInputComplete:!1,cardExpiryMonthInputComplete:!1,cardExpiryYearInputComplete:!1,formReadyForSubmission:!1,formSubmitted:!1,modalOpen:!1,isPolling:!1,isAuthenticatingTds:!1,transactionId:null,threeDSTransactionId:null,challengeRetry:!1,challengeTime:null,challengeTimeout:120,payload:null},this.config={},this.elements={}}getConfig(){return this.config}setConfig(t){this.config=t}getElementFromReference(t){return this.elements instanceof s||(this.elements=new s(this.config)),this.elements.getReference(t)}getCurrentState(){return this.state}updateState(t){if("object"!=typeof this.state)throw new Error("Unable to update state, expected an object but received "+typeof this.state+".");for(const[e,n]of Object.entries(t))this.state[e]=n;return this}getStateParameter(t){return t in this.state?this.state[t]:null}setStateParameter(t,e){return this.state[t]=e,this}static getInstance(){return a.instance||(a.instance=new a),a.instance}isModalOpen(){return!0===this.state.modalOpen}isModalClosed(){return!1===this.state.modalOpen}isFormReadyForSubmission(){return this.state.formReadyForSubmission&&!this.state.formSubmitted}isFormSubmitted(){return this.state.formSubmitted}isLoading(){return this.state.loading}isPolling(){return this.state.isPolling}isChallengeRetry(){return this.state.challengeRetry}isChallengeRetryValid(){return null!==this.state.transactionId&&null!==this.state.threeDSTransactionId&&(this.state.challengeRetry&&this.state.challengeTime+this.state.challengeTimeout>Math.floor(Date.now()/1e3))}}class o extends Error{}class l extends o{}class c{static get onRequestEvent(){return"onRequestEvent"}static get onPaymentAuthorizeEvent(){return"onPaymentAuthorizeEvent"}static get onResponseEvent(){return"onResponseEvent"}static get onPollingResponseEvent(){return"onPollingResponseEvent"}static get onResponseFactoryEvent(){return"onResponseFactoryEvent"}static get onStateChangeEvent(){return"onStateChangeEvent"}static get onResolveModalEvent(){return"onResolveModalEvent"}static get onModalOpenEvent(){return"onModalOpenEvent"}static get onModalCloseEvent(){return"onModalCloseEvent"}static get onDebugEvent(){return"onDebugEvent"}static get onPaymentRequiresTdsMethodEvent(){return"onPaymentRequiresTdsMethodEvent"}static get onPaymentAuthenticateEvent(){return"onPaymentAuthenticateEvent"}static get onActionableResponseEvent(){return"onActionableResponseEvent"}static get onPaymentFailedEvent(){return"onPaymentFailedEvent"}static get onPaymentCanceledEvent(){return"onPaymentCanceledEvent"}static get onPaymentCompleteEvent(){return"onPaymentCompleteEvent"}static get onPaymentRequiresChallengeEvent(){return"onPaymentRequiresChallengeEvent"}static get onSubmitDataEvent(){return"onSubmitDataEvent"}static get onBeforeDisplayModalEvent(){return"onBeforeDisplayModalEvent"}}class u{constructor(){this.instance=null,this.listeners=[],this.sorted=[]}static getInstance(){return u.instance||(u.instance=new u),u.instance}getListeners(t){if(t)return Array.isArray(this.listeners[t])&&0!==this.listeners[t].length?(t in this.sorted&&0!==this.sorted[t].length||this.sortListeners(t),this.sorted[t]):[];for(const[t,e]of Object.entries(this.listeners))t in this.sorted||this.sortListeners(t);return this.sorted}addListener(t,e,n=0){if(n<0)throw new Error("Priority must be a non-negative index.");return t in this.listeners||(this.listeners[t]=[]),n in this.listeners[t]||(this.listeners[t][n]=[]),this.listeners[t][n].push(e),t in this.sorted&&delete this.sorted[t],this}removeListener(t,e){if(this.listeners[t])for(const[n,r]of Object.entries(this.listeners[t])){for(const[i,s]of Object.entries(r))Array.isArray(s)&&2===s.length&&s[0]===e[0]&&s[1]===e[1]&&(delete this.listeners[t][n][i],delete this.sorted[t]),s===e&&(delete this.listeners[t][n][i],delete this.sorted[t]);0===Object.entries(this.listeners[t][n]).length&&delete this.listeners[t][n]}}dispatch(t,e){let n=this.getListeners(e);return n.length>0&&this.callListeners(n,e,t),t}callListeners(t,e,n){try{t.forEach((function(t){if(n.propagationStopped)throw new l;if(Array.isArray(t)&&2===t.length){if("function"!=typeof t[0][t[1]])throw new Error("Could not call method on listener instance.");t[0][t[1]](n,e,this)}else t(n,e,this)}))}catch(t){if(t instanceof l)return;throw t}}hasListeners(t=null){return t?this.listeners[t]&&this.sorted[t].length>0:this.listeners.length>0}sortListeners(t){this.sorted[t]=[];let e=this.listeners[t].sort(((t,e)=>t>e?1:-1));for(const n of Object.keys(e))for(const r of e[n])this.sorted[t].push(r);return this.sorted}getListenerPriority(t,e){if(this.listeners[t]){for(const[n,r]of Object.entries(this.listeners[t]))for(const t of r){if(Array.isArray(t)&&2===t.length&&t[0]===e[0]&&t[1]===e[1])return n;if(t===e)return n}return null}}}class h{getEventDispatcher(){return u.getInstance()}getState(){return a.getInstance()}}class d extends n{}class p extends n{constructor(t,e={}){super(t,e=Object.assign({},{redirection_enabled:!0,redirection_url:null,redirection_timeout:2500},e))}}class g extends n{}class f extends t{constructor(t){super(t)}getTransactionStatusCode(){return void 0===this.data.transactionStatusCode?null:Number(this.data.transactionStatusCode)}getTransactionId(){return void 0===this.data.transactionID?null:this.data.transactionID}}class m extends e{constructor(t){super(t)}getErrorMessage(){return this.data.errorMessage}getErrorCode(){return Number(this.data.errorCode)}getErrorTag(){return this.data.errorCode}getStatus(){return this.data.status}getMessage(){return this.getErrorMessage()}getLevel(){return this.data.level}}class v extends n{}class y extends r{}class b extends n{getCurrentState(){return a.getInstance()}}class E extends h{static onActionableResponse(t){let e=t.getSubject(),n=e.getNextAction(),r=t.getParameter("config"),i=t.getParameter("encryptedForm"),s=t.getParameter("poller");if(s.clear(),e instanceof m){let n=new v(e,{encryptedForm:i,originalEvent:t,paymentCompleteUrl:r.payment_complete_url});u.getInstance().dispatch(n,c.onPaymentFailedEvent)}switch("challenged"!==n&&"tdsMethod"!==n||s.poll(r.status_url.replace("%transaction_id%",e.getThreeDSTransactionId()),(n=>{fetch(n,{method:"GET",cache:"no-cache"}).then((t=>{if(200!==t.status)throw Error("Unexpected status code returned");return t.json().catch((()=>{throw new Error("Invalid JSON returned.")}))})).then((t=>{let e=new g(new f(t),{encryptedForm:i,config:r,poller:s});u.getInstance().dispatch(e,c.onPollingResponseEvent)})).catch((n=>{s.clear(),u.getInstance().dispatch(new v(e,{encryptedForm:i,originalEvent:t,paymentCompleteUrl:r.payment_complete_url}),c.onPaymentFailedEvent)}))})),n){case"challenged":u.getInstance().dispatch(new d(e,{poller:s,encryptedForm:i}),c.onPaymentRequiresChallengeEvent),u.getInstance().dispatch(new b(t,{state:{challengeTime:Math.floor(Date.now()/1e3)}}),c.onStateChangeEvent);break;case"tdsMethod":u.getInstance().dispatch(new y(e,{poller:s,encryptedForm:i}),c.onPaymentRequiresTdsMethodEvent);break;case"paid":case"redirectToShop":u.getInstance().dispatch(new p(e,{encryptedForm:i,paymentCompleteUrl:r.payment_complete_url,urlParameters:{orderId:e.data.orderId,entranceCode:e.data.entranceCode}}),c.onPaymentCompleteEvent);break;case"retryChallenge":u.getInstance().dispatch(new b(t,{state:{challengeRetry:!0}}),c.onStateChangeEvent)}}}class S extends n{}class w{constructor(t,e={}){this.response=t,this.config=Object.assign({},{onShow:()=>{u.getInstance().dispatch(new b(null,{state:{modalOpen:!0}}),c.onStateChangeEvent)},onClose:()=>{let t=a.getInstance().getElementFromReference(i.modalContainer),e={modalOpen:!1};a.getInstance().isFormSubmitted()&&(e.formSubmitted=!1),u.getInstance().dispatch(new b(null,{state:e}),c.onStateChangeEvent),u.getInstance().dispatch(new S(this,{manual:!0}),c.onModalCloseEvent),void 0!==t&&(t.innerHTML="")},awaitOpenAnimation:!1,awaitCloseAnimation:!1},e)}getConfig(){return this.config}}class C extends w{constructor(t){super(t)}render(t={}){return"Authorizing..."}}class D extends e{constructor(t){super(t)}isRedirectionChallenge(){return void 0!==this.data.challengeType&&"redirect"===this.data.challengeType}isIFrameChallenge(){return void 0!==this.data.challengeType&&"iframe"===this.data.challengeType}getChallengeType(){return this.data.challengeType}getChallengeForm(){return this.data.challengeForm}getChallengeWindowWidth(){return this.data.challengeWindowWidth}getChallengeWindowHeight(){return this.data.challengeWindowHeight}getTdsMode(){return this.data.tdsMode}getType(){return"challenged"}}class T extends w{constructor(t){super(t)}render(t={}){let e="<html><head></head><body>"+atob(this.response.getChallengeForm())+'<script type="text/javascript">(function(){ document.querySelector("form").submit() })();<\/script></body></html>';return'<iframe id="challenge-iframe" src="data:text/html;charset=utf-8,'+encodeURI(e)+'"></iframe>'}}var x="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},I=function(t,e,n,r,i,s,a,o,l,c){var u=this;u.numeralDecimalMark=t||".",u.numeralIntegerScale=e>0?e:0,u.numeralDecimalScale=n>=0?n:2,u.numeralThousandsGroupStyle=r||I.groupStyle.thousand,u.numeralPositiveOnly=!!i,u.stripLeadingZeroes=!1!==s,u.prefix=a||""===a?a:"",u.signBeforePrefix=!!o,u.tailPrefix=!!l,u.delimiter=c||""===c?c:",",u.delimiterRE=c?new RegExp("\\"+c,"g"):""};I.groupStyle={thousand:"thousand",lakh:"lakh",wan:"wan",none:"none"},I.prototype={getRawValue:function(t){return t.replace(this.delimiterRE,"").replace(this.numeralDecimalMark,".")},format:function(t){var e,n,r,i,s=this,a="";switch(t=t.replace(/[A-Za-z]/g,"").replace(s.numeralDecimalMark,"M").replace(/[^\dM-]/g,"").replace(/^\-/,"N").replace(/\-/g,"").replace("N",s.numeralPositiveOnly?"":"-").replace("M",s.numeralDecimalMark),s.stripLeadingZeroes&&(t=t.replace(/^(-)?0+(?=\d)/,"$1")),n="-"===t.slice(0,1)?"-":"",r=void 0!==s.prefix?s.signBeforePrefix?n+s.prefix:s.prefix+n:n,i=t,t.indexOf(s.numeralDecimalMark)>=0&&(i=(e=t.split(s.numeralDecimalMark))[0],a=s.numeralDecimalMark+e[1].slice(0,s.numeralDecimalScale)),"-"===n&&(i=i.slice(1)),s.numeralIntegerScale>0&&(i=i.slice(0,s.numeralIntegerScale)),s.numeralThousandsGroupStyle){case I.groupStyle.lakh:i=i.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+s.delimiter);break;case I.groupStyle.wan:i=i.replace(/(\d)(?=(\d{4})+$)/g,"$1"+s.delimiter);break;case I.groupStyle.thousand:i=i.replace(/(\d)(?=(\d{3})+$)/g,"$1"+s.delimiter)}return s.tailPrefix?n+i.toString()+(s.numeralDecimalScale>0?a.toString():"")+s.prefix:r+i.toString()+(s.numeralDecimalScale>0?a.toString():"")}};var P=I,R=function(t,e,n){var r=this;r.date=[],r.blocks=[],r.datePattern=t,r.dateMin=e.split("-").reverse().map((function(t){return parseInt(t,10)})),2===r.dateMin.length&&r.dateMin.unshift(0),r.dateMax=n.split("-").reverse().map((function(t){return parseInt(t,10)})),2===r.dateMax.length&&r.dateMax.unshift(0),r.initBlocks()};R.prototype={initBlocks:function(){var t=this;t.datePattern.forEach((function(e){"Y"===e?t.blocks.push(4):t.blocks.push(2)}))},getISOFormatDate:function(){var t=this,e=t.date;return e[2]?e[2]+"-"+t.addLeadingZero(e[1])+"-"+t.addLeadingZero(e[0]):""},getBlocks:function(){return this.blocks},getValidatedDate:function(t){var e=this,n="";return t=t.replace(/[^\d]/g,""),e.blocks.forEach((function(r,i){if(t.length>0){var s=t.slice(0,r),a=s.slice(0,1),o=t.slice(r);switch(e.datePattern[i]){case"d":"00"===s?s="01":parseInt(a,10)>3?s="0"+a:parseInt(s,10)>31&&(s="31");break;case"m":"00"===s?s="01":parseInt(a,10)>1?s="0"+a:parseInt(s,10)>12&&(s="12")}n+=s,t=o}})),this.getFixedDateString(n)},getFixedDateString:function(t){var e,n,r,i=this,s=i.datePattern,a=[],o=0,l=0,c=0,u=0,h=0,d=0,p=!1;return 4===t.length&&"y"!==s[0].toLowerCase()&&"y"!==s[1].toLowerCase()&&(h=2-(u="d"===s[0]?0:2),e=parseInt(t.slice(u,u+2),10),n=parseInt(t.slice(h,h+2),10),a=this.getFixedDate(e,n,0)),8===t.length&&(s.forEach((function(t,e){switch(t){case"d":o=e;break;case"m":l=e;break;default:c=e}})),d=2*c,u=o<=c?2*o:2*o+2,h=l<=c?2*l:2*l+2,e=parseInt(t.slice(u,u+2),10),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+4),10),p=4===t.slice(d,d+4).length,a=this.getFixedDate(e,n,r)),4!==t.length||"y"!==s[0]&&"y"!==s[1]||(d=2-(h="m"===s[0]?0:2),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+2),10),p=2===t.slice(d,d+2).length,a=[0,n,r]),6!==t.length||"Y"!==s[0]&&"Y"!==s[1]||(d=2-.5*(h="m"===s[0]?0:4),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+4),10),p=4===t.slice(d,d+4).length,a=[0,n,r]),a=i.getRangeFixedDate(a),i.date=a,0===a.length?t:s.reduce((function(t,e){switch(e){case"d":return t+(0===a[0]?"":i.addLeadingZero(a[0]));case"m":return t+(0===a[1]?"":i.addLeadingZero(a[1]));case"y":return t+(p?i.addLeadingZeroForYear(a[2],!1):"");case"Y":return t+(p?i.addLeadingZeroForYear(a[2],!0):"")}}),"")},getRangeFixedDate:function(t){var e=this,n=e.datePattern,r=e.dateMin||[],i=e.dateMax||[];return!t.length||r.length<3&&i.length<3||n.find((function(t){return"y"===t.toLowerCase()}))&&0===t[2]?t:i.length&&(i[2]<t[2]||i[2]===t[2]&&(i[1]<t[1]||i[1]===t[1]&&i[0]<t[0]))?i:r.length&&(r[2]>t[2]||r[2]===t[2]&&(r[1]>t[1]||r[1]===t[1]&&r[0]>t[0]))?r:t},getFixedDate:function(t,e,n){return t=Math.min(t,31),e=Math.min(e,12),n=parseInt(n||0,10),(e<7&&e%2==0||e>8&&e%2==1)&&(t=Math.min(t,2===e?this.isLeapYear(n)?29:28:30)),[t,e,n]},isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},addLeadingZero:function(t){return(t<10?"0":"")+t},addLeadingZeroForYear:function(t,e){return e?(t<10?"000":t<100?"00":t<1e3?"0":"")+t:(t<10?"0":"")+t}};var A=R,M=function(t,e){var n=this;n.time=[],n.blocks=[],n.timePattern=t,n.timeFormat=e,n.initBlocks()};M.prototype={initBlocks:function(){var t=this;t.timePattern.forEach((function(){t.blocks.push(2)}))},getISOFormatTime:function(){var t=this,e=t.time;return e[2]?t.addLeadingZero(e[0])+":"+t.addLeadingZero(e[1])+":"+t.addLeadingZero(e[2]):""},getBlocks:function(){return this.blocks},getTimeFormatOptions:function(){return"12"===String(this.timeFormat)?{maxHourFirstDigit:1,maxHours:12,maxMinutesFirstDigit:5,maxMinutes:60}:{maxHourFirstDigit:2,maxHours:23,maxMinutesFirstDigit:5,maxMinutes:60}},getValidatedTime:function(t){var e=this,n="";t=t.replace(/[^\d]/g,"");var r=e.getTimeFormatOptions();return e.blocks.forEach((function(i,s){if(t.length>0){var a=t.slice(0,i),o=a.slice(0,1),l=t.slice(i);switch(e.timePattern[s]){case"h":parseInt(o,10)>r.maxHourFirstDigit?a="0"+o:parseInt(a,10)>r.maxHours&&(a=r.maxHours+"");break;case"m":case"s":parseInt(o,10)>r.maxMinutesFirstDigit?a="0"+o:parseInt(a,10)>r.maxMinutes&&(a=r.maxMinutes+"")}n+=a,t=l}})),this.getFixedTimeString(n)},getFixedTimeString:function(t){var e,n,r,i=this,s=i.timePattern,a=[],o=0,l=0,c=0,u=0,h=0,d=0;return 6===t.length&&(s.forEach((function(t,e){switch(t){case"s":o=2*e;break;case"m":l=2*e;break;case"h":c=2*e}})),d=c,h=l,u=o,e=parseInt(t.slice(u,u+2),10),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+2),10),a=this.getFixedTime(r,n,e)),4===t.length&&i.timePattern.indexOf("s")<0&&(s.forEach((function(t,e){switch(t){case"m":l=2*e;break;case"h":c=2*e}})),d=c,h=l,e=0,n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+2),10),a=this.getFixedTime(r,n,e)),i.time=a,0===a.length?t:s.reduce((function(t,e){switch(e){case"s":return t+i.addLeadingZero(a[2]);case"m":return t+i.addLeadingZero(a[1]);case"h":return t+i.addLeadingZero(a[0])}}),"")},getFixedTime:function(t,e,n){return n=Math.min(parseInt(n||0,10),60),e=Math.min(e,60),[t=Math.min(t,60),e,n]},addLeadingZero:function(t){return(t<10?"0":"")+t}};var O=M,B=function(t,e){var n=this;n.delimiter=e||""===e?e:" ",n.delimiterRE=e?new RegExp("\\"+e,"g"):"",n.formatter=t};B.prototype={setFormatter:function(t){this.formatter=t},format:function(t){var e=this;e.formatter.clear();for(var n,r="",i=!1,s=0,a=(t=(t=(t=t.replace(/[^\d+]/g,"")).replace(/^\+/,"B").replace(/\+/g,"").replace("B","+")).replace(e.delimiterRE,"")).length;s<a;s++)n=e.formatter.inputDigit(t.charAt(s)),/[\s()-]/g.test(n)?(r=n,i=!0):i||(r=n);return r=(r=r.replace(/[()]/g,"")).replace(/[\s-]/g,e.delimiter)}};var L=B,V={blocks:{uatp:[4,5,6],amex:[4,6,5],diners:[4,6,4],discover:[4,4,4,4],mastercard:[4,4,4,4],dankort:[4,4,4,4],instapayment:[4,4,4,4],jcb15:[4,6,5],jcb:[4,4,4,4],maestro:[4,4,4,4],visa:[4,4,4,4],mir:[4,4,4,4],unionPay:[4,4,4,4],general:[4,4,4,4]},re:{uatp:/^(?!1800)1\d{0,14}/,amex:/^3[47]\d{0,13}/,discover:/^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,diners:/^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,mastercard:/^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,dankort:/^(5019|4175|4571)\d{0,12}/,instapayment:/^63[7-9]\d{0,13}/,jcb15:/^(?:2131|1800)\d{0,11}/,jcb:/^(?:35\d{0,2})\d{0,12}/,maestro:/^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,mir:/^220[0-4]\d{0,12}/,visa:/^4\d{0,15}/,unionPay:/^(62|81)\d{0,14}/},getStrictBlocks:function(t){var e=t.reduce((function(t,e){return t+e}),0);return t.concat(19-e)},getInfo:function(t,e){var n=V.blocks,r=V.re;for(var i in e=!!e,r)if(r[i].test(t)){var s=n[i];return{type:i,blocks:e?this.getStrictBlocks(s):s}}return{type:"unknown",blocks:e?this.getStrictBlocks(n.general):n.general}}},F=V,_={noop:function(){},strip:function(t,e){return t.replace(e,"")},getPostDelimiter:function(t,e,n){if(0===n.length)return t.slice(-e.length)===e?e:"";var r="";return n.forEach((function(e){t.slice(-e.length)===e&&(r=e)})),r},getDelimiterREByDelimiter:function(t){return new RegExp(t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g")},getNextCursorPosition:function(t,e,n,r,i){return e.length===t?n.length:t+this.getPositionOffset(t,e,n,r,i)},getPositionOffset:function(t,e,n,r,i){var s,a,o;return s=this.stripDelimiters(e.slice(0,t),r,i),a=this.stripDelimiters(n.slice(0,t),r,i),0!==(o=s.length-a.length)?o/Math.abs(o):0},stripDelimiters:function(t,e,n){var r=this;if(0===n.length){var i=e?r.getDelimiterREByDelimiter(e):"";return t.replace(i,"")}return n.forEach((function(e){e.split("").forEach((function(e){t=t.replace(r.getDelimiterREByDelimiter(e),"")}))})),t},headStr:function(t,e){return t.slice(0,e)},getMaxLength:function(t){return t.reduce((function(t,e){return t+e}),0)},getPrefixStrippedValue:function(t,e,n,r,i,s,a,o,l){if(0===n)return t;if(t===e&&""!==t)return"";if(l&&"-"==t.slice(0,1)){var c="-"==r.slice(0,1)?r.slice(1):r;return"-"+this.getPrefixStrippedValue(t.slice(1),e,n,c,i,s,a,o,l)}if(r.slice(0,n)!==e&&!o)return a&&!r&&t?t:"";if(r.slice(-n)!==e&&o)return a&&!r&&t?t:"";var u=this.stripDelimiters(r,i,s);return t.slice(0,n)===e||o?t.slice(-n)!==e&&o?u.slice(0,-n-1):o?t.slice(0,-n):t.slice(n):u.slice(n)},getFirstDiffIndex:function(t,e){for(var n=0;t.charAt(n)===e.charAt(n);)if(""===t.charAt(n++))return-1;return n},getFormattedValue:function(t,e,n,r,i,s){var a="",o=i.length>0,l="";return 0===n?t:(e.forEach((function(e,c){if(t.length>0){var u=t.slice(0,e),h=t.slice(e);l=o?i[s?c-1:c]||l:r,s?(c>0&&(a+=l),a+=u):(a+=u,u.length===e&&c<n-1&&(a+=l)),t=h}})),a)},fixPrefixCursor:function(t,e,n,r){if(t){var i=t.value,s=n||r[0]||" ";if(t.setSelectionRange&&e&&!(e.length+s.length<=i.length)){var a=2*i.length;setTimeout((function(){t.setSelectionRange(a,a)}),1)}}},checkFullSelection:function(t){try{return(window.getSelection()||document.getSelection()||{}).toString().length===t.length}catch(t){}return!1},setSelection:function(t,e,n){if(t===this.getActiveElement(n)&&!(t&&t.value.length<=e))if(t.createTextRange){var r=t.createTextRange();r.move("character",e),r.select()}else try{t.setSelectionRange(e,e)}catch(t){console.warn("The input element type does not support selection")}},getActiveElement:function(t){var e=t.activeElement;return e&&e.shadowRoot?this.getActiveElement(e.shadowRoot):e},isAndroid:function(){return navigator&&/android/i.test(navigator.userAgent)},isAndroidBackspaceKeydown:function(t,e){return!!(this.isAndroid()&&t&&e)&&e===t.slice(0,-1)}},k={assign:function(t,e){return e=e||{},(t=t||{}).creditCard=!!e.creditCard,t.creditCardStrictMode=!!e.creditCardStrictMode,t.creditCardType="",t.onCreditCardTypeChanged=e.onCreditCardTypeChanged||function(){},t.phone=!!e.phone,t.phoneRegionCode=e.phoneRegionCode||"AU",t.phoneFormatter={},t.time=!!e.time,t.timePattern=e.timePattern||["h","m","s"],t.timeFormat=e.timeFormat||"24",t.timeFormatter={},t.date=!!e.date,t.datePattern=e.datePattern||["d","m","Y"],t.dateMin=e.dateMin||"",t.dateMax=e.dateMax||"",t.dateFormatter={},t.numeral=!!e.numeral,t.numeralIntegerScale=e.numeralIntegerScale>0?e.numeralIntegerScale:0,t.numeralDecimalScale=e.numeralDecimalScale>=0?e.numeralDecimalScale:2,t.numeralDecimalMark=e.numeralDecimalMark||".",t.numeralThousandsGroupStyle=e.numeralThousandsGroupStyle||"thousand",t.numeralPositiveOnly=!!e.numeralPositiveOnly,t.stripLeadingZeroes=!1!==e.stripLeadingZeroes,t.signBeforePrefix=!!e.signBeforePrefix,t.tailPrefix=!!e.tailPrefix,t.swapHiddenInput=!!e.swapHiddenInput,t.numericOnly=t.creditCard||t.date||!!e.numericOnly,t.uppercase=!!e.uppercase,t.lowercase=!!e.lowercase,t.prefix=t.creditCard||t.date?"":e.prefix||"",t.noImmediatePrefix=!!e.noImmediatePrefix,t.prefixLength=t.prefix.length,t.rawValueTrimPrefix=!!e.rawValueTrimPrefix,t.copyDelimiter=!!e.copyDelimiter,t.initValue=void 0!==e.initValue&&null!==e.initValue?e.initValue.toString():"",t.delimiter=e.delimiter||""===e.delimiter?e.delimiter:e.date?"/":e.time?":":e.numeral?",":(e.phone," "),t.delimiterLength=t.delimiter.length,t.delimiterLazyShow=!!e.delimiterLazyShow,t.delimiters=e.delimiters||[],t.blocks=e.blocks||[],t.blocksLength=t.blocks.length,t.root="object"==typeof x&&x?x:window,t.document=e.document||t.root.document,t.maxLength=0,t.backspace=!1,t.result="",t.onValueChanged=e.onValueChanged||function(){},t}},N=function(t,e){var n=this,r=!1;if("string"==typeof t?(n.element=document.querySelector(t),r=document.querySelectorAll(t).length>1):void 0!==t.length&&t.length>0?(n.element=t[0],r=t.length>1):n.element=t,!n.element)throw new Error("[cleave.js] Please check the element");if(r)try{console.warn("[cleave.js] Multiple input fields matched, cleave.js will only take the first one.")}catch(t){}e.initValue=n.element.value,n.properties=N.DefaultProperties.assign({},e),n.init()};N.prototype={init:function(){var t=this,e=t.properties;e.numeral||e.phone||e.creditCard||e.time||e.date||0!==e.blocksLength||e.prefix?(e.maxLength=N.Util.getMaxLength(e.blocks),t.isAndroid=N.Util.isAndroid(),t.lastInputValue="",t.isBackward="",t.onChangeListener=t.onChange.bind(t),t.onKeyDownListener=t.onKeyDown.bind(t),t.onFocusListener=t.onFocus.bind(t),t.onCutListener=t.onCut.bind(t),t.onCopyListener=t.onCopy.bind(t),t.initSwapHiddenInput(),t.element.addEventListener("input",t.onChangeListener),t.element.addEventListener("keydown",t.onKeyDownListener),t.element.addEventListener("focus",t.onFocusListener),t.element.addEventListener("cut",t.onCutListener),t.element.addEventListener("copy",t.onCopyListener),t.initPhoneFormatter(),t.initDateFormatter(),t.initTimeFormatter(),t.initNumeralFormatter(),(e.initValue||e.prefix&&!e.noImmediatePrefix)&&t.onInput(e.initValue)):t.onInput(e.initValue)},initSwapHiddenInput:function(){var t=this;if(t.properties.swapHiddenInput){var e=t.element.cloneNode(!0);t.element.parentNode.insertBefore(e,t.element),t.elementSwapHidden=t.element,t.elementSwapHidden.type="hidden",t.element=e,t.element.id=""}},initNumeralFormatter:function(){var t=this.properties;t.numeral&&(t.numeralFormatter=new N.NumeralFormatter(t.numeralDecimalMark,t.numeralIntegerScale,t.numeralDecimalScale,t.numeralThousandsGroupStyle,t.numeralPositiveOnly,t.stripLeadingZeroes,t.prefix,t.signBeforePrefix,t.tailPrefix,t.delimiter))},initTimeFormatter:function(){var t=this.properties;t.time&&(t.timeFormatter=new N.TimeFormatter(t.timePattern,t.timeFormat),t.blocks=t.timeFormatter.getBlocks(),t.blocksLength=t.blocks.length,t.maxLength=N.Util.getMaxLength(t.blocks))},initDateFormatter:function(){var t=this.properties;t.date&&(t.dateFormatter=new N.DateFormatter(t.datePattern,t.dateMin,t.dateMax),t.blocks=t.dateFormatter.getBlocks(),t.blocksLength=t.blocks.length,t.maxLength=N.Util.getMaxLength(t.blocks))},initPhoneFormatter:function(){var t=this.properties;if(t.phone)try{t.phoneFormatter=new N.PhoneFormatter(new t.root.Cleave.AsYouTypeFormatter(t.phoneRegionCode),t.delimiter)}catch(t){throw new Error("[cleave.js] Please include phone-type-formatter.{country}.js lib")}},onKeyDown:function(t){var e=this,n=t.which||t.keyCode;e.lastInputValue=e.element.value,e.isBackward=8===n},onChange:function(t){var e=this,n=e.properties,r=N.Util;e.isBackward=e.isBackward||"deleteContentBackward"===t.inputType;var i=r.getPostDelimiter(e.lastInputValue,n.delimiter,n.delimiters);e.isBackward&&i?n.postDelimiterBackspace=i:n.postDelimiterBackspace=!1,this.onInput(this.element.value)},onFocus:function(){var t=this,e=t.properties;t.lastInputValue=t.element.value,e.prefix&&e.noImmediatePrefix&&!t.element.value&&this.onInput(e.prefix),N.Util.fixPrefixCursor(t.element,e.prefix,e.delimiter,e.delimiters)},onCut:function(t){N.Util.checkFullSelection(this.element.value)&&(this.copyClipboardData(t),this.onInput(""))},onCopy:function(t){N.Util.checkFullSelection(this.element.value)&&this.copyClipboardData(t)},copyClipboardData:function(t){var e=this.properties,n=N.Util,r=this.element.value,i="";i=e.copyDelimiter?r:n.stripDelimiters(r,e.delimiter,e.delimiters);try{t.clipboardData?t.clipboardData.setData("Text",i):window.clipboardData.setData("Text",i),t.preventDefault()}catch(t){}},onInput:function(t){var e=this,n=e.properties,r=N.Util,i=r.getPostDelimiter(t,n.delimiter,n.delimiters);return n.numeral||!n.postDelimiterBackspace||i||(t=r.headStr(t,t.length-n.postDelimiterBackspace.length)),n.phone?(!n.prefix||n.noImmediatePrefix&&!t.length?n.result=n.phoneFormatter.format(t):n.result=n.prefix+n.phoneFormatter.format(t).slice(n.prefix.length),void e.updateValueState()):n.numeral?(n.prefix&&n.noImmediatePrefix&&0===t.length?n.result="":n.result=n.numeralFormatter.format(t),void e.updateValueState()):(n.date&&(t=n.dateFormatter.getValidatedDate(t)),n.time&&(t=n.timeFormatter.getValidatedTime(t)),t=r.stripDelimiters(t,n.delimiter,n.delimiters),t=r.getPrefixStrippedValue(t,n.prefix,n.prefixLength,n.result,n.delimiter,n.delimiters,n.noImmediatePrefix,n.tailPrefix,n.signBeforePrefix),t=n.numericOnly?r.strip(t,/[^\d]/g):t,t=n.uppercase?t.toUpperCase():t,t=n.lowercase?t.toLowerCase():t,n.prefix&&(n.tailPrefix?t+=n.prefix:t=n.prefix+t,0===n.blocksLength)?(n.result=t,void e.updateValueState()):(n.creditCard&&e.updateCreditCardPropsByValue(t),t=r.headStr(t,n.maxLength),n.result=r.getFormattedValue(t,n.blocks,n.blocksLength,n.delimiter,n.delimiters,n.delimiterLazyShow),void e.updateValueState()))},updateCreditCardPropsByValue:function(t){var e,n=this.properties,r=N.Util;r.headStr(n.result,4)!==r.headStr(t,4)&&(e=N.CreditCardDetector.getInfo(t,n.creditCardStrictMode),n.blocks=e.blocks,n.blocksLength=n.blocks.length,n.maxLength=r.getMaxLength(n.blocks),n.creditCardType!==e.type&&(n.creditCardType=e.type,n.onCreditCardTypeChanged.call(this,n.creditCardType)))},updateValueState:function(){var t=this,e=N.Util,n=t.properties;if(t.element){var r=t.element.selectionEnd,i=t.element.value,s=n.result;r=e.getNextCursorPosition(r,i,s,n.delimiter,n.delimiters),t.isAndroid?window.setTimeout((function(){t.element.value=s,e.setSelection(t.element,r,n.document,!1),t.callOnValueChanged()}),1):(t.element.value=s,n.swapHiddenInput&&(t.elementSwapHidden.value=t.getRawValue()),e.setSelection(t.element,r,n.document,!1),t.callOnValueChanged())}},callOnValueChanged:function(){var t=this,e=t.properties;e.onValueChanged.call(t,{target:{name:t.element.name,value:e.result,rawValue:t.getRawValue()}})},setPhoneRegionCode:function(t){var e=this;e.properties.phoneRegionCode=t,e.initPhoneFormatter(),e.onChange()},setRawValue:function(t){var e=this,n=e.properties;t=null!=t?t.toString():"",n.numeral&&(t=t.replace(".",n.numeralDecimalMark)),n.postDelimiterBackspace=!1,e.element.value=t,e.onInput(t)},getRawValue:function(){var t=this.properties,e=N.Util,n=this.element.value;return t.rawValueTrimPrefix&&(n=e.getPrefixStrippedValue(n,t.prefix,t.prefixLength,t.result,t.delimiter,t.delimiters,t.noImmediatePrefix,t.tailPrefix,t.signBeforePrefix)),n=t.numeral?t.numeralFormatter.getRawValue(n):e.stripDelimiters(n,t.delimiter,t.delimiters)},getISOFormatDate:function(){var t=this.properties;return t.date?t.dateFormatter.getISOFormatDate():""},getISOFormatTime:function(){var t=this.properties;return t.time?t.timeFormatter.getISOFormatTime():""},getFormattedValue:function(){return this.element.value},destroy:function(){var t=this;t.element.removeEventListener("input",t.onChangeListener),t.element.removeEventListener("keydown",t.onKeyDownListener),t.element.removeEventListener("focus",t.onFocusListener),t.element.removeEventListener("cut",t.onCutListener),t.element.removeEventListener("copy",t.onCopyListener)},toString:function(){return"[Cleave Object]"}},N.NumeralFormatter=P,N.DateFormatter=A,N.TimeFormatter=O,N.PhoneFormatter=L,N.CreditCardDetector=F,N.Util=_,N.DefaultProperties=k,("object"==typeof x&&x?x:window).Cleave=N;var j=N;class U extends n{}class H extends h{static onDebugEvent(t){if(t.getSubject()instanceof Error)throw t.getSubject();t.getParameters().length>0?t instanceof U?console.debug(t.event,t.event.getParameters()):console.debug(t.getSubject(),t.getParameters()):console.debug(t.getSubject())}static onDebugNull(){}static onModalCloseEvent(t){u.getInstance().dispatch(new U("Closing modal",{event:t}),c.onDebugEvent)}static onModalOpenEvent(t){u.getInstance().dispatch(new U("Opening modal",{event:t}),c.onDebugEvent)}static onRequestEvent(t){u.getInstance().dispatch(new U("Request received.",{event:t}),c.onDebugEvent)}static onResponseEvent(t){u.getInstance().dispatch(new U("Response received",{event:t}),c.onDebugEvent)}static onResponseFactoryEvent(t){u.getInstance().dispatch(new U("Response factory has resolved response",{event:t}),c.onDebugEvent)}static onStateChangeEvent(t){u.getInstance().dispatch(new U("State has been updated",{event:t,state:t.getCurrentState(),change:t.parameters}),c.onDebugEvent)}static onPaymentCompleteEvent(t){u.getInstance().dispatch(new U("Payment was successfully completed.",{event:t}),c.onDebugEvent)}static onPaymentFailedEvent(t){u.getInstance().dispatch(new U("Payment has failed.",{event:t}),c.onDebugEvent)}}class q extends w{render(t={}){let e=this.response.getMessage();return void 0===e&&(e="Unknown error occurred."),`${e}`}}class K extends o{}class z{static onStateChangeEvent(t){if(!(t instanceof b))throw new K("PaymentFormListener only supports StateChangeEvent.");let e=a.getInstance();z.formElementsDisable(e)}static formElementsDisable(t){let e=[t.getElementFromReference(i.creditCardHolder),t.getElementFromReference(i.creditCardNumber),t.getElementFromReference(i.creditCardCvv),t.getElementFromReference(i.creditCardExpiration),t.getElementFromReference(i.creditCardExpirationMonth),t.getElementFromReference(i.creditCardExpirationYear)];for(const n in Object.keys(e)){let r=e[n];r&&(t.isFormSubmitted()?(r.hasAttribute("disabled")||r.setAttribute("disabled","disabled"),r.hasAttribute("required")&&r.removeAttribute("required")):(r.hasAttribute("disabled")&&r.removeAttribute("disabled"),r.hasAttribute("required")||r.setAttribute("required","required")))}}}class Y{static onStateChangeEvent(t){if(!(t instanceof b))throw new K("PaymentFormListener only supports StateChangeEvent.");let e=a.getInstance();Y.formSubmission(e)}static formSubmission(t){let e=t.getElementFromReference(i.submitButton);e.setAttribute("data-loading-state",t.isLoading()||t.isFormSubmitted()?"1":"0"),t.isFormReadyForSubmission()?e.removeAttribute("disabled"):e.hasAttribute("disabled")||e.setAttribute("disabled","disabled")}}class Z{constructor(t,e,n){this.identifier=t,this.key=atob(e),this.expiresAt=n}getKey(){return this.key}isValid(){return!this.isExpired()}isExpired(){return new Date>this.expiresAt}}class ${static create(t,e,n){return new Z(t,e,n)}static fromJson(t){let e=[];for(let n of t||[])e.push(this.create(n.identifier,n.public_key,n.expires_at));return e}}class J{constructor(t,e){this.publicKeys=t,this.refreshUrl=e}getUnexpiredPublicKey(){return new Promise(((t,e)=>this.all().then((n=>{void 0!==n&&n.length>0&&t(n[0]),e(Error("Unable to fetch keys"))})).catch((t=>{throw t}))))}all(){return new Promise(((t,e)=>{let n=this.publicKeys.filter((function(t){return t.isValid()}));if(!(n.length>0))return this.refreshPublicKeys().then((e=>{this.publicKeys=e,t(e)})).catch((t=>{e(t)}));t(n)}))}refreshPublicKeys(){return Promise.race([fetch(this.refreshUrl).then(((t,e)=>{if(t.ok)return t;e(Error("Unexpected response from server."))})).then((t=>t.json().catch((()=>{throw new Error("Invalid JSON returned.")})))).then((t=>$.fromJson(t))).catch((()=>[])),new Promise(((t,e)=>setTimeout((()=>e(new Error("timeout"))),3e3)))])}}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function W(t){return function(t){if(Array.isArray(t))return Q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var X=function(){var t=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],e=function(){function e(t){var n=t.targetModal,r=t.triggers,i=void 0===r?[]:r,s=t.onShow,a=void 0===s?function(){}:s,o=t.onClose,l=void 0===o?function(){}:o,c=t.openTrigger,u=void 0===c?"data-micromodal-trigger":c,h=t.closeTrigger,d=void 0===h?"data-micromodal-close":h,p=t.openClass,g=void 0===p?"is-open":p,f=t.disableScroll,m=void 0!==f&&f,v=t.disableFocus,y=void 0!==v&&v,b=t.awaitCloseAnimation,E=void 0!==b&&b,S=t.awaitOpenAnimation,w=void 0!==S&&S,C=t.debugMode,D=void 0!==C&&C;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.modal=document.getElementById(n),this.config={debugMode:D,disableScroll:m,openTrigger:u,closeTrigger:d,openClass:g,onShow:a,onClose:l,awaitCloseAnimation:E,awaitOpenAnimation:w,disableFocus:y},i.length>0&&this.registerTriggers.apply(this,W(i)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var n,r,i;return n=e,(r=[{key:"registerTriggers",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.filter(Boolean).forEach((function(e){e.addEventListener("click",(function(e){return t.showModal(e)}))}))}},{key:"showModal",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var n=function e(){t.modal.removeEventListener("animationend",e,!1),t.setFocusToFirstNode()};this.modal.addEventListener("animationend",n,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,e)}},{key:"closeModal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,t),this.config.awaitCloseAnimation){var n=this.config.openClass;this.modal.addEventListener("animationend",(function t(){e.classList.remove(n),e.removeEventListener("animationend",t,!1)}),!1)}else e.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(t){this.modal=document.getElementById(t),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(t){if(this.config.disableScroll){var e=document.querySelector("body");switch(t){case"enable":Object.assign(e.style,{overflow:""});break;case"disable":Object.assign(e.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(t){t.target.hasAttribute(this.config.closeTrigger)&&this.closeModal(t)}},{key:"onKeydown",value:function(t){27===t.keyCode&&this.closeModal(t),9===t.keyCode&&this.retainFocus(t)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(t);return Array.apply(void 0,W(e))}},{key:"setFocusToFirstNode",value:function(){var t=this;if(!this.config.disableFocus){var e=this.getFocusableNodes();if(0!==e.length){var n=e.filter((function(e){return!e.hasAttribute(t.config.closeTrigger)}));n.length>0&&n[0].focus(),0===n.length&&e[0].focus()}}}},{key:"retainFocus",value:function(t){var e=this.getFocusableNodes();if(0!==e.length)if(e=e.filter((function(t){return null!==t.offsetParent})),this.modal.contains(document.activeElement)){var n=e.indexOf(document.activeElement);t.shiftKey&&0===n&&(e[e.length-1].focus(),t.preventDefault()),!t.shiftKey&&e.length>0&&n===e.length-1&&(e[0].focus(),t.preventDefault())}else e[0].focus()}}])&&G(n.prototype,r),i&&G(n,i),e}(),n=null,r=function(t){if(!document.getElementById(t))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(t,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(t,'"></div>')),!1},i=function(t,e){if(function(t){if(t.length<=0)console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>')}(t),!e)return!0;for(var n in e)r(n);return!0};return{init:function(t){var r=Object.assign({},{openTrigger:"data-micromodal-trigger"},t),s=W(document.querySelectorAll("[".concat(r.openTrigger,"]"))),a=function(t,e){var n=[];return t.forEach((function(t){var r=t.attributes[e].value;void 0===n[r]&&(n[r]=[]),n[r].push(t)})),n}(s,r.openTrigger);if(!0!==r.debugMode||!1!==i(s,a))for(var o in a){var l=a[o];r.targetModal=o,r.triggers=W(l),n=new e(r)}},show:function(t,i){var s=i||{};s.targetModal=t,!0===s.debugMode&&!1===r(t)||(n&&n.removeEventListeners(),(n=new e(s)).showModal())},close:function(t){t?n.closeModalById(t):n.closeModal()}}}();window.MicroModal=X;class tt{constructor(){this.state=a.getInstance(),this.modalReference=this.state.getElementFromReference(i.modalContainer),this.currentModal=null,X.init({})}static getInstance(){return tt.instance||(tt.instance=new tt),tt.instance}open(t,e={}){if(t instanceof w)return this.currentModal=t,this.setBody(t,e),X.show("payment-modal",t.getConfig()),t}close(t){return this.currentModal=null,X.close("payment-modal"),this.modalReference.innerHTML="",t}setBody(t,e={}){if(!(t instanceof w))return;for(;this.modalReference.firstChild;)this.modalReference.removeChild(this.modalReference.firstChild);let r=t.render(e),i=new n(r,{modal:t,parameters:e});if(u.getInstance().dispatch(i,c.onBeforeDisplayModalEvent),!i.isPropagationStopped()){let t=(new DOMParser).parseFromString(i.getSubject(),"text/html");this.modalReference.appendChild(t.body.firstChild)}}}class et extends h{static onModalOpen(t){tt.getInstance().open(t.subject,t.parameters)}static onModalClose(t){t.hasParameter("manual")||tt.getInstance().close(t.subject,t.parameters)}}class nt extends n{}var rt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function it(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function st(t,e){return t(e={exports:{}},e.exports),e.exports}var at=it(st((function(t,e){!function(t){var e="0123456789abcdefghijklmnopqrstuvwxyz";function n(t){return e.charAt(t)}function r(t,e){return t&e}function i(t,e){return t|e}function s(t,e){return t^e}function a(t,e){return t&~e}function o(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function l(t){for(var e=0;0!=t;)t&=t-1,++e;return e}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="=";function h(t){var e,n,r="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),r+=c.charAt(n>>6)+c.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),r+=c.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),r+=c.charAt(n>>2)+c.charAt((3&n)<<4));(3&r.length)>0;)r+=u;return r}function d(t){var e,r="",i=0,s=0;for(e=0;e<t.length&&t.charAt(e)!=u;++e){var a=c.indexOf(t.charAt(e));a<0||(0==i?(r+=n(a>>2),s=3&a,i=1):1==i?(r+=n(s<<2|a>>4),s=15&a,i=2):2==i?(r+=n(s),r+=n(a>>2),s=3&a,i=3):(r+=n(s<<2|a>>4),r+=n(15&a),i=0))}return 1==i&&(r+=n(s<<2)),r}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var p,g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var m,v={decode:function(t){var e;if(void 0===p){var n="0123456789ABCDEF",r=" \f\n\r\t \u2028\u2029";for(p={},e=0;e<16;++e)p[n.charAt(e)]=e;for(n=n.toLowerCase(),e=10;e<16;++e)p[n.charAt(e)]=e;for(e=0;e<r.length;++e)p[r.charAt(e)]=-1}var i=[],s=0,a=0;for(e=0;e<t.length;++e){var o=t.charAt(e);if("="==o)break;if(-1!=(o=p[o])){if(void 0===o)throw new Error("Illegal character at offset "+e);s|=o,++a>=2?(i[i.length]=s,s=0,a=0):s<<=4}}if(a)throw new Error("Hex encoding incomplete: 4 bits missing");return i}},y={decode:function(t){var e;if(void 0===m){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="= \f\n\r\t \u2028\u2029";for(m=Object.create(null),e=0;e<64;++e)m[n.charAt(e)]=e;for(e=0;e<r.length;++e)m[r.charAt(e)]=-1}var i=[],s=0,a=0;for(e=0;e<t.length;++e){var o=t.charAt(e);if("="==o)break;if(-1!=(o=m[o])){if(void 0===o)throw new Error("Illegal character at offset "+e);s|=o,++a>=4?(i[i.length]=s>>16,i[i.length]=s>>8&255,i[i.length]=255&s,s=0,a=0):s<<=6}}switch(a){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:i[i.length]=s>>10;break;case 3:i[i.length]=s>>16,i[i.length]=s>>8&255}return i},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(t){var e=y.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw new Error("RegExp out of sync");t=e[2]}return y.decode(t)}},b=1e13,E=function(){function t(t){this.buf=[+t||0]}return t.prototype.mulAdd=function(t,e){var n,r,i=this.buf,s=i.length;for(n=0;n<s;++n)(r=i[n]*t+e)<b?e=0:r-=(e=0|r/b)*b,i[n]=r;e>0&&(i[n]=e)},t.prototype.sub=function(t){var e,n,r=this.buf,i=r.length;for(e=0;e<i;++e)(n=r[e]-t)<0?(n+=b,t=1):t=0,r[e]=n;for(;0===r[r.length-1];)r.pop()},t.prototype.toString=function(t){if(10!=(t||10))throw new Error("only base 10 is supported");for(var e=this.buf,n=e[e.length-1].toString(),r=e.length-2;r>=0;--r)n+=(b+e[r]).toString().substring(1);return n},t.prototype.valueOf=function(){for(var t=this.buf,e=0,n=t.length-1;n>=0;--n)e=e*b+t[n];return e},t.prototype.simplify=function(){var t=this.buf;return 1==t.length?t[0]:this},t}(),S="…",w=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,C=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function D(t,e){return t.length>e&&(t=t.substring(0,e)+S),t}var T,x=function(){function t(e,n){this.hexDigits="0123456789ABCDEF",e instanceof t?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=n)}return t.prototype.get=function(t){if(void 0===t&&(t=this.pos++),t>=this.enc.length)throw new Error("Requesting byte offset "+t+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(t):this.enc[t]},t.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},t.prototype.hexDump=function(t,e,n){for(var r="",i=t;i<e;++i)if(r+=this.hexByte(this.get(i)),!0!==n)switch(15&i){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r},t.prototype.isASCII=function(t,e){for(var n=t;n<e;++n){var r=this.get(n);if(r<32||r>176)return!1}return!0},t.prototype.parseStringISO=function(t,e){for(var n="",r=t;r<e;++r)n+=String.fromCharCode(this.get(r));return n},t.prototype.parseStringUTF=function(t,e){for(var n="",r=t;r<e;){var i=this.get(r++);n+=i<128?String.fromCharCode(i):i>191&&i<224?String.fromCharCode((31&i)<<6|63&this.get(r++)):String.fromCharCode((15&i)<<12|(63&this.get(r++))<<6|63&this.get(r++))}return n},t.prototype.parseStringBMP=function(t,e){for(var n,r,i="",s=t;s<e;)n=this.get(s++),r=this.get(s++),i+=String.fromCharCode(n<<8|r);return i},t.prototype.parseTime=function(t,e,n){var r=this.parseStringISO(t,e),i=(n?w:C).exec(r);return i?(n&&(i[1]=+i[1],i[1]+=+i[1]<70?2e3:1900),r=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(r+=":"+i[5],i[6]&&(r+=":"+i[6],i[7]&&(r+="."+i[7]))),i[8]&&(r+=" UTC","Z"!=i[8]&&(r+=i[8],i[9]&&(r+=":"+i[9]))),r):"Unrecognized time: "+r},t.prototype.parseInteger=function(t,e){for(var n,r=this.get(t),i=r>127,s=i?255:0,a="";r==s&&++t<e;)r=this.get(t);if(0==(n=e-t))return i?-1:0;if(n>4){for(a=r,n<<=3;0==(128&(+a^s));)a=+a<<1,--n;a="("+n+" bit)\n"}i&&(r-=256);for(var o=new E(r),l=t+1;l<e;++l)o.mulAdd(256,this.get(l));return a+o.toString()},t.prototype.parseBitString=function(t,e,n){for(var r=this.get(t),i="("+((e-t-1<<3)-r)+" bit)\n",s="",a=t+1;a<e;++a){for(var o=this.get(a),l=a==e-1?r:0,c=7;c>=l;--c)s+=o>>c&1?"1":"0";if(s.length>n)return i+D(s,n)}return i+s},t.prototype.parseOctetString=function(t,e,n){if(this.isASCII(t,e))return D(this.parseStringISO(t,e),n);var r=e-t,i="("+r+" byte)\n";r>(n/=2)&&(e=t+n);for(var s=t;s<e;++s)i+=this.hexByte(this.get(s));return r>n&&(i+=S),i},t.prototype.parseOID=function(t,e,n){for(var r="",i=new E,s=0,a=t;a<e;++a){var o=this.get(a);if(i.mulAdd(128,127&o),s+=7,!(128&o)){if(""===r)if((i=i.simplify())instanceof E)i.sub(80),r="2."+i.toString();else{var l=i<80?i<40?0:1:2;r=l+"."+(i-40*l)}else r+="."+i.toString();if(r.length>n)return D(r,n);i=new E,s=0}}return s>0&&(r+=".incomplete"),r},t}(),I=function(){function t(t,e,n,r,i){if(!(r instanceof P))throw new Error("Invalid tag value.");this.stream=t,this.header=e,this.length=n,this.tag=r,this.sub=i}return t.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},t.prototype.content=function(t){if(void 0===this.tag)return null;void 0===t&&(t=1/0);var e=this.posContent(),n=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+n,t);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(e)?"false":"true";case 2:return this.stream.parseInteger(e,e+n);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+n,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+n,t);case 6:return this.stream.parseOID(e,e+n,t);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return D(this.stream.parseStringUTF(e,e+n),t);case 18:case 19:case 20:case 21:case 22:case 26:return D(this.stream.parseStringISO(e,e+n),t);case 30:return D(this.stream.parseStringBMP(e,e+n),t);case 23:case 24:return this.stream.parseTime(e,e+n,23==this.tag.tagNumber)}return null},t.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},t.prototype.toPrettyString=function(t){void 0===t&&(t="");var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,this.tag.tagConstructed?e+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(e+=" (encapsulates)"),e+="\n",null!==this.sub){t+="  ";for(var n=0,r=this.sub.length;n<r;++n)e+=this.sub[n].toPrettyString(t)}return e},t.prototype.posStart=function(){return this.stream.pos},t.prototype.posContent=function(){return this.stream.pos+this.header},t.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},t.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},t.decodeLength=function(t){var e=t.get(),n=127&e;if(n==e)return n;if(n>6)throw new Error("Length over 48 bits not supported at position "+(t.pos-1));if(0===n)return null;e=0;for(var r=0;r<n;++r)e=256*e+t.get();return e},t.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,n=2*this.length;return t.substr(e,n)},t.decode=function(e){var n;n=e instanceof x?e:new x(e,0);var r=new x(n),i=new P(n),s=t.decodeLength(n),a=n.pos,o=a-r.pos,l=null,c=function(){var e=[];if(null!==s){for(var r=a+s;n.pos<r;)e[e.length]=t.decode(n);if(n.pos!=r)throw new Error("Content size is not correct for container starting at offset "+a)}else try{for(;;){var i=t.decode(n);if(i.tag.isEOC())break;e[e.length]=i}s=a-n.pos}catch(t){throw new Error("Exception while decoding undefined length content: "+t)}return e};if(i.tagConstructed)l=c();else if(i.isUniversal()&&(3==i.tagNumber||4==i.tagNumber))try{if(3==i.tagNumber&&0!=n.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");l=c();for(var u=0;u<l.length;++u)if(l[u].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(t){l=null}if(null===l){if(null===s)throw new Error("We can't skip over an invalid tag with undefined length at offset "+a);n.pos=a+Math.abs(s)}return new t(r,o,s,i,l)},t}(),P=function(){function t(t){var e=t.get();if(this.tagClass=e>>6,this.tagConstructed=0!=(32&e),this.tagNumber=31&e,31==this.tagNumber){var n=new E;do{e=t.get(),n.mulAdd(128,127&e)}while(128&e);this.tagNumber=n.simplify()}}return t.prototype.isUniversal=function(){return 0===this.tagClass},t.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},t}(),R=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A=(1<<26)/R[R.length-1],M=function(){function t(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}return t.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,s=!1,a="",o=this.t,l=this.DB-o*this.DB%e;if(o-- >0)for(l<this.DB&&(r=this[o]>>l)>0&&(s=!0,a=n(r));o>=0;)l<e?(r=(this[o]&(1<<l)-1)<<e-l,r|=this[--o]>>(l+=this.DB-e)):(r=this[o]>>(l-=e)&i,l<=0&&(l+=this.DB,--o)),r>0&&(s=!0),s&&(a+=n(r));return s?a:"0"},t.prototype.negate=function(){var e=F();return t.ZERO.subTo(this,e),e},t.prototype.abs=function(){return this.s<0?this.negate():this},t.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},t.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Z(this[this.t-1]^this.s&this.DM)},t.prototype.mod=function(e){var n=F();return this.abs().divRemTo(e,null,n),this.s<0&&n.compareTo(t.ZERO)>0&&e.subTo(n,n),n},t.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new B(e):new L(e),this.exp(t,n)},t.prototype.clone=function(){var t=F();return this.copyTo(t),t},t.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},t.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},t.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},t.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},t.prototype.toByteArray=function(){var t=this.t,e=[];e[0]=this.s;var n,r=this.DB-t*this.DB%8,i=0;if(t-- >0)for(r<this.DB&&(n=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this[t]&(1<<r)-1)<<8-r,n|=this[--t]>>(r+=this.DB-8)):(n=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e},t.prototype.equals=function(t){return 0==this.compareTo(t)},t.prototype.min=function(t){return this.compareTo(t)<0?this:t},t.prototype.max=function(t){return this.compareTo(t)>0?this:t},t.prototype.and=function(t){var e=F();return this.bitwiseTo(t,r,e),e},t.prototype.or=function(t){var e=F();return this.bitwiseTo(t,i,e),e},t.prototype.xor=function(t){var e=F();return this.bitwiseTo(t,s,e),e},t.prototype.andNot=function(t){var e=F();return this.bitwiseTo(t,a,e),e},t.prototype.not=function(){for(var t=F(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},t.prototype.shiftLeft=function(t){var e=F();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},t.prototype.shiftRight=function(t){var e=F();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},t.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+o(this[t]);return this.s<0?this.t*this.DB:-1},t.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=l(this[n]^e);return t},t.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},t.prototype.setBit=function(t){return this.changeBit(t,i)},t.prototype.clearBit=function(t){return this.changeBit(t,a)},t.prototype.flipBit=function(t){return this.changeBit(t,s)},t.prototype.add=function(t){var e=F();return this.addTo(t,e),e},t.prototype.subtract=function(t){var e=F();return this.subTo(t,e),e},t.prototype.multiply=function(t){var e=F();return this.multiplyTo(t,e),e},t.prototype.divide=function(t){var e=F();return this.divRemTo(t,e,null),e},t.prototype.remainder=function(t){var e=F();return this.divRemTo(t,null,e),e},t.prototype.divideAndRemainder=function(t){var e=F(),n=F();return this.divRemTo(t,e,n),[e,n]},t.prototype.modPow=function(t,e){var n,r,i=t.bitLength(),s=Y(1);if(i<=0)return s;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new B(e):e.isEven()?new V(e):new L(e);var a=[],o=3,l=n-1,c=(1<<n)-1;if(a[1]=r.convert(this),n>1){var u=F();for(r.sqrTo(a[1],u);o<=c;)a[o]=F(),r.mulTo(u,a[o-2],a[o]),o+=2}var h,d,p=t.t-1,g=!0,f=F();for(i=Z(t[p])-1;p>=0;){for(i>=l?h=t[p]>>i-l&c:(h=(t[p]&(1<<i+1)-1)<<l-i,p>0&&(h|=t[p-1]>>this.DB+i-l)),o=n;0==(1&h);)h>>=1,--o;if((i-=o)<0&&(i+=this.DB,--p),g)a[h].copyTo(s),g=!1;else{for(;o>1;)r.sqrTo(s,f),r.sqrTo(f,s),o-=2;o>0?r.sqrTo(s,f):(d=s,s=f,f=d),r.mulTo(f,a[h],s)}for(;p>=0&&0==(t[p]&1<<i);)r.sqrTo(s,f),d=s,s=f,f=d,--i<0&&(i=this.DB-1,--p)}return r.revert(s)},t.prototype.modInverse=function(e){var n=e.isEven();if(this.isEven()&&n||0==e.signum())return t.ZERO;for(var r=e.clone(),i=this.clone(),s=Y(1),a=Y(0),o=Y(0),l=Y(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),n?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;i.isEven();)i.rShiftTo(1,i),n?(o.isEven()&&l.isEven()||(o.addTo(this,o),l.subTo(e,l)),o.rShiftTo(1,o)):l.isEven()||l.subTo(e,l),l.rShiftTo(1,l);r.compareTo(i)>=0?(r.subTo(i,r),n&&s.subTo(o,s),a.subTo(l,a)):(i.subTo(r,i),n&&o.subTo(s,o),l.subTo(a,l))}return 0!=i.compareTo(t.ONE)?t.ZERO:l.compareTo(e)>=0?l.subtract(e):l.signum()<0?(l.addTo(e,l),l.signum()<0?l.add(e):l):l},t.prototype.pow=function(t){return this.exp(t,new O)},t.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var r=e;e=n,n=r}var i=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},t.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=R[R.length-1]){for(e=0;e<R.length;++e)if(n[0]==R[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<R.length;){for(var r=R[e],i=e+1;i<R.length&&r<A;)r*=R[i++];for(r=n.modInt(r);e<i;)if(r%R[e++]==0)return!1}return n.millerRabin(t)},t.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},t.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},t.prototype.fromString=function(e,n){var r;if(16==n)r=4;else if(8==n)r=3;else if(256==n)r=8;else if(2==n)r=1;else if(32==n)r=5;else{if(4!=n)return void this.fromRadix(e,n);r=2}this.t=0,this.s=0;for(var i=e.length,s=!1,a=0;--i>=0;){var o=8==r?255&+e[i]:z(e,i);o<0?"-"==e.charAt(i)&&(s=!0):(s=!1,0==a?this[this.t++]=o:a+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this[this.t++]=o>>this.DB-a):this[this.t-1]|=o<<a,(a+=r)>=this.DB&&(a-=this.DB))}8==r&&0!=(128&+e[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),s&&t.ZERO.subTo(this,this)},t.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},t.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},t.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},t.prototype.lShiftTo=function(t,e){for(var n=t%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(t/this.DB),a=this.s<<n&this.DM,o=this.t-1;o>=0;--o)e[o+s+1]=this[o]>>r|a,a=(this[o]&i)<<n;for(o=s-1;o>=0;--o)e[o]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()},t.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,s=(1<<r)-1;e[0]=this[n]>>r;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&s)<<i,e[a-n]=this[a]>>r;r>0&&(e[this.t-n-1]|=(this.s&s)<<i),e.t=this.t-n,e.clamp()}},t.prototype.subTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]-t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r-=t[n],e[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[n++]=this.DV+r:r>0&&(e[n++]=r),e.t=n,e.clamp()},t.prototype.multiplyTo=function(e,n){var r=this.abs(),i=e.abs(),s=r.t;for(n.t=s+i.t;--s>=0;)n[s]=0;for(s=0;s<i.t;++s)n[s+r.t]=r.am(0,i[s],n,s,0,r.t);n.s=0,n.clamp(),this.s!=e.s&&t.ZERO.subTo(n,n)},t.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},t.prototype.divRemTo=function(e,n,r){var i=e.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=n&&n.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=F());var a=F(),o=this.s,l=e.s,c=this.DB-Z(i[i.t-1]);c>0?(i.lShiftTo(c,a),s.lShiftTo(c,r)):(i.copyTo(a),s.copyTo(r));var u=a.t,h=a[u-1];if(0!=h){var d=h*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0),p=this.FV/d,g=(1<<this.F1)/d,f=1<<this.F2,m=r.t,v=m-u,y=null==n?F():n;for(a.dlShiftTo(v,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),t.ONE.dlShiftTo(u,y),y.subTo(a,a);a.t<u;)a[a.t++]=0;for(;--v>=0;){var b=r[--m]==h?this.DM:Math.floor(r[m]*p+(r[m-1]+f)*g);if((r[m]+=a.am(0,b,r,v,0,u))<b)for(a.dlShiftTo(v,y),r.subTo(y,r);r[m]<--b;)r.subTo(y,r)}null!=n&&(r.drShiftTo(u,n),o!=l&&t.ZERO.subTo(n,n)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&t.ZERO.subTo(r,r)}}},t.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},t.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},t.prototype.exp=function(e,n){if(e>4294967295||e<1)return t.ONE;var r=F(),i=F(),s=n.convert(this),a=Z(e)-1;for(s.copyTo(r);--a>=0;)if(n.sqrTo(r,i),(e&1<<a)>0)n.mulTo(i,s,r);else{var o=r;r=i,i=o}return n.revert(r)},t.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},t.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=Y(n),i=F(),s=F(),a="";for(this.divRemTo(r,i,s);i.signum()>0;)a=(n+s.intValue()).toString(t).substr(1)+a,i.divRemTo(r,i,s);return s.intValue().toString(t)+a},t.prototype.fromRadix=function(e,n){this.fromInt(0),null==n&&(n=10);for(var r=this.chunkSize(n),i=Math.pow(n,r),s=!1,a=0,o=0,l=0;l<e.length;++l){var c=z(e,l);c<0?"-"==e.charAt(l)&&0==this.signum()&&(s=!0):(o=n*o+c,++a>=r&&(this.dMultiply(i),this.dAddOffset(o,0),a=0,o=0))}a>0&&(this.dMultiply(Math.pow(n,a)),this.dAddOffset(o,0)),s&&t.ZERO.subTo(this,this)},t.prototype.fromNumber=function(e,n,r){if("number"==typeof n)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),i,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this);else{var s=[],a=7&e;s.length=1+(e>>3),n.nextBytes(s),a>0?s[0]&=(1<<a)-1:s[0]=0,this.fromString(s,256)}},t.prototype.bitwiseTo=function(t,e,n){var r,i,s=Math.min(t.t,this.t);for(r=0;r<s;++r)n[r]=e(this[r],t[r]);if(t.t<this.t){for(i=t.s&this.DM,r=s;r<this.t;++r)n[r]=e(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=s;r<t.t;++r)n[r]=e(i,t[r]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},t.prototype.changeBit=function(e,n){var r=t.ONE.shiftLeft(e);return this.bitwiseTo(r,n,r),r},t.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]+t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t[n],e[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[n++]=r:r<-1&&(e[n++]=this.DV+r),e.t=n,e.clamp()},t.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},t.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},t.prototype.multiplyLowerTo=function(t,e,n){var r=Math.min(this.t+t.t,e);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(var i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(i=Math.min(t.t,e);r<i;++r)this.am(0,t[r],n,r,0,e-r);n.clamp()},t.prototype.multiplyUpperTo=function(t,e,n){--e;var r=n.t=this.t+t.t-e;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n[this.t+r-e]=this.am(e-r,t[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)},t.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var r=this.t-1;r>=0;--r)n=(e*n+this[r])%t;return n},t.prototype.millerRabin=function(e){var n=this.subtract(t.ONE),r=n.getLowestSetBit();if(r<=0)return!1;var i=n.shiftRight(r);(e=e+1>>1)>R.length&&(e=R.length);for(var s=F(),a=0;a<e;++a){s.fromInt(R[Math.floor(Math.random()*R.length)]);var o=s.modPow(i,this);if(0!=o.compareTo(t.ONE)&&0!=o.compareTo(n)){for(var l=1;l++<r&&0!=o.compareTo(n);)if(0==(o=o.modPowInt(2,this)).compareTo(t.ONE))return!1;if(0!=o.compareTo(n))return!1}}return!0},t.prototype.square=function(){var t=F();return this.squareTo(t),t},t.prototype.gcda=function(t,e){var n=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(n.compareTo(r)<0){var i=n;n=r,r=i}var s=n.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)e(n);else{s<a&&(a=s),a>0&&(n.rShiftTo(a,n),r.rShiftTo(a,r));var o=function(){(s=n.getLowestSetBit())>0&&n.rShiftTo(s,n),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),n.compareTo(r)>=0?(n.subTo(r,n),n.rShiftTo(1,n)):(r.subTo(n,r),r.rShiftTo(1,r)),n.signum()>0?setTimeout(o,0):(a>0&&r.lShiftTo(a,r),setTimeout((function(){e(r)}),0))};setTimeout(o,10)}},t.prototype.fromNumberAsync=function(e,n,r,s){if("number"==typeof n)if(e<2)this.fromInt(1);else{this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),i,this),this.isEven()&&this.dAddOffset(1,0);var a=this,o=function(){a.dAddOffset(2,0),a.bitLength()>e&&a.subTo(t.ONE.shiftLeft(e-1),a),a.isProbablePrime(n)?setTimeout((function(){s()}),0):setTimeout(o,0)};setTimeout(o,0)}else{var l=[],c=7&e;l.length=1+(e>>3),n.nextBytes(l),c>0?l[0]&=(1<<c)-1:l[0]=0,this.fromString(l,256)}},t}(),O=function(){function t(){}return t.prototype.convert=function(t){return t},t.prototype.revert=function(t){return t},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},t.prototype.sqrTo=function(t,e){t.squareTo(e)},t}(),B=function(){function t(t){this.m=t}return t.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},t.prototype.revert=function(t){return t},t.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}(),L=function(){function t(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}return t.prototype.convert=function(t){var e=F();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(M.ZERO)>0&&this.m.subTo(e,e),e},t.prototype.revert=function(t){var e=F();return t.copyTo(e),this.reduce(e),e},t.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}(),V=function(){function t(t){this.m=t,this.r2=F(),this.q3=F(),M.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t)}return t.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=F();return t.copyTo(e),this.reduce(e),e},t.prototype.revert=function(t){return t},t.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}();function F(){return new M(null)}function _(t,e){return new M(t,e)}function k(t,e,n,r,i,s){for(;--s>=0;){var a=e*this[t++]+n[r]+i;i=Math.floor(a/67108864),n[r++]=67108863&a}return i}function N(t,e,n,r,i,s){for(var a=32767&e,o=e>>15;--s>=0;){var l=32767&this[t],c=this[t++]>>15,u=o*l+c*a;i=((l=a*l+((32767&u)<<15)+n[r]+(1073741823&i))>>>30)+(u>>>15)+o*c+(i>>>30),n[r++]=1073741823&l}return i}function j(t,e,n,r,i,s){for(var a=16383&e,o=e>>14;--s>=0;){var l=16383&this[t],c=this[t++]>>14,u=o*l+c*a;i=((l=a*l+((16383&u)<<14)+n[r]+i)>>28)+(u>>14)+o*c,n[r++]=268435455&l}return i}"Microsoft Internet Explorer"==navigator.appName?(M.prototype.am=N,T=30):"Netscape"!=navigator.appName?(M.prototype.am=k,T=26):(M.prototype.am=j,T=28),M.prototype.DB=T,M.prototype.DM=(1<<T)-1,M.prototype.DV=1<<T;var U=52;M.prototype.FV=Math.pow(2,U),M.prototype.F1=U-T,M.prototype.F2=2*T-U;var H,q,K=[];for(H="0".charCodeAt(0),q=0;q<=9;++q)K[H++]=q;for(H="a".charCodeAt(0),q=10;q<36;++q)K[H++]=q;for(H="A".charCodeAt(0),q=10;q<36;++q)K[H++]=q;function z(t,e){var n=K[t.charCodeAt(e)];return null==n?-1:n}function Y(t){var e=F();return e.fromInt(t),e}function Z(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}M.ZERO=Y(0),M.ONE=Y(1);var $=function(){function t(){this.i=0,this.j=0,this.S=[]}return t.prototype.init=function(t){var e,n,r;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[n],this.S[n]=r;this.i=0,this.j=0},t.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},t}();function J(){return new $}var G,W,Q=256,X=null;if(null==X){X=[],W=0;var tt=void 0;if(window.crypto&&window.crypto.getRandomValues){var et=new Uint32Array(256);for(window.crypto.getRandomValues(et),tt=0;tt<et.length;++tt)X[W++]=255&et[tt]}var nt=function(t){if(this.count=this.count||0,this.count>=256||W>=Q)window.removeEventListener?window.removeEventListener("mousemove",nt,!1):window.detachEvent&&window.detachEvent("onmousemove",nt);else try{var e=t.x+t.y;X[W++]=255&e,this.count+=1}catch(t){}};window.addEventListener?window.addEventListener("mousemove",nt,!1):window.attachEvent&&window.attachEvent("onmousemove",nt)}function rt(){if(null==G){for(G=J();W<Q;){var t=Math.floor(65536*Math.random());X[W++]=255&t}for(G.init(X),W=0;W<X.length;++W)X[W]=0;W=0}return G.next()}var it=function(){function t(){}return t.prototype.nextBytes=function(t){for(var e=0;e<t.length;++e)t[e]=rt()},t}();function st(t,e){if(e<t.length+22)return console.error("Message too long for RSA"),null;for(var n=e-t.length-6,r="",i=0;i<n;i+=2)r+="ff";return _("0001"+r+"00"+t,16)}function at(t,e){if(e<t.length+11)return console.error("Message too long for RSA"),null;for(var n=[],r=t.length-1;r>=0&&e>0;){var i=t.charCodeAt(r--);i<128?n[--e]=i:i>127&&i<2048?(n[--e]=63&i|128,n[--e]=i>>6|192):(n[--e]=63&i|128,n[--e]=i>>6&63|128,n[--e]=i>>12|224)}n[--e]=0;for(var s=new it,a=[];e>2;){for(a[0]=0;0==a[0];)s.nextBytes(a);n[--e]=a[0]}return n[--e]=2,n[--e]=0,new M(n)}var ot=function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return t.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},t.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},t.prototype.setPublic=function(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=_(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")},t.prototype.encrypt=function(t){var e=at(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},t.prototype.setPrivate=function(t,e,n){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=_(t,16),this.e=parseInt(e,16),this.d=_(n,16)):console.error("Invalid RSA private key")},t.prototype.setPrivateEx=function(t,e,n,r,i,s,a,o){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=_(t,16),this.e=parseInt(e,16),this.d=_(n,16),this.p=_(r,16),this.q=_(i,16),this.dmp1=_(s,16),this.dmq1=_(a,16),this.coeff=_(o,16)):console.error("Invalid RSA private key")},t.prototype.generate=function(t,e){var n=new it,r=t>>1;this.e=parseInt(e,16);for(var i=new M(e,16);;){for(;this.p=new M(t-r,1,n),0!=this.p.subtract(M.ONE).gcd(i).compareTo(M.ONE)||!this.p.isProbablePrime(10););for(;this.q=new M(r,1,n),0!=this.q.subtract(M.ONE).gcd(i).compareTo(M.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var a=this.p.subtract(M.ONE),o=this.q.subtract(M.ONE),l=a.multiply(o);if(0==l.gcd(i).compareTo(M.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(l),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}},t.prototype.decrypt=function(t){var e=_(t,16),n=this.doPrivate(e);return null==n?null:lt(n,this.n.bitLength()+7>>3)},t.prototype.generateAsync=function(t,e,n){var r=new it,i=t>>1;this.e=parseInt(e,16);var s=new M(e,16),a=this,o=function(){var e=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var e=a.p.subtract(M.ONE),r=a.q.subtract(M.ONE),i=e.multiply(r);0==i.gcd(s).compareTo(M.ONE)?(a.n=a.p.multiply(a.q),a.d=s.modInverse(i),a.dmp1=a.d.mod(e),a.dmq1=a.d.mod(r),a.coeff=a.q.modInverse(a.p),setTimeout((function(){n()}),0)):setTimeout(o,0)},l=function(){a.q=F(),a.q.fromNumberAsync(i,1,r,(function(){a.q.subtract(M.ONE).gcda(s,(function(t){0==t.compareTo(M.ONE)&&a.q.isProbablePrime(10)?setTimeout(e,0):setTimeout(l,0)}))}))},c=function(){a.p=F(),a.p.fromNumberAsync(t-i,1,r,(function(){a.p.subtract(M.ONE).gcda(s,(function(t){0==t.compareTo(M.ONE)&&a.p.isProbablePrime(10)?setTimeout(l,0):setTimeout(c,0)}))}))};setTimeout(c,0)};setTimeout(o,0)},t.prototype.sign=function(t,e,n){var r=st(ut(n)+e(t).toString(),this.n.bitLength()/4);if(null==r)return null;var i=this.doPrivate(r);if(null==i)return null;var s=i.toString(16);return 0==(1&s.length)?s:"0"+s},t.prototype.verify=function(t,e,n){var r=_(e,16),i=this.doPublic(r);return null==i?null:ht(i.toString(16).replace(/^1f+00/,""))==n(t).toString()},t}();function lt(t,e){for(var n=t.toByteArray(),r=0;r<n.length&&0==n[r];)++r;if(n.length-r!=e-1||2!=n[r])return null;for(++r;0!=n[r];)if(++r>=n.length)return null;for(var i="";++r<n.length;){var s=255&n[r];s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((31&s)<<6|63&n[r+1]),++r):(i+=String.fromCharCode((15&s)<<12|(63&n[r+1])<<6|63&n[r+2]),r+=2)}return i}var ct={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function ut(t){return ct[t]||""}function ht(t){for(var e in ct)if(ct.hasOwnProperty(e)){var n=ct[e],r=n.length;if(t.substr(0,r)==n)return t.substr(r)}return t}
/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/var dt={};dt.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var r=function(){};if(r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var i;for(i in n)t.prototype[i]=n[i];var s=function(){},a=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(s=function(t,e){for(i=0;i<a.length;i+=1){var n=a[i],r=e[n];"function"==typeof r&&r!=Object.prototype[n]&&(t[n]=r)}})}catch(t){}s(t.prototype,n)}}};
/**
 * @fileOverview
 * @name asn1-1.0.js
 * @author Kenji Urushima kenji.urushima@gmail.com
 * @version asn1 1.0.13 (2017-Jun-02)
 * @since jsrsasign 2.1
 * @license <a href="https://kjur.github.io/jsrsasign/license/">MIT License</a>
 */
var pt={};void 0!==pt.asn1&&pt.asn1||(pt.asn1={}),pt.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var r="",i=0;i<n;i++)r+="f";e=new M(r,16).xor(t).add(M.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return hextopem(t,e)},this.newObject=function(t){var e=pt.asn1,n=e.DERBoolean,r=e.DERInteger,i=e.DERBitString,s=e.DEROctetString,a=e.DERNull,o=e.DERObjectIdentifier,l=e.DEREnumerated,c=e.DERUTF8String,u=e.DERNumericString,h=e.DERPrintableString,d=e.DERTeletexString,p=e.DERIA5String,g=e.DERUTCTime,f=e.DERGeneralizedTime,m=e.DERSequence,v=e.DERSet,y=e.DERTaggedObject,b=e.ASN1Util.newObject,E=Object.keys(t);if(1!=E.length)throw"key of param shall be only one.";var S=E[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+S+":"))throw"undefined key: "+S;if("bool"==S)return new n(t[S]);if("int"==S)return new r(t[S]);if("bitstr"==S)return new i(t[S]);if("octstr"==S)return new s(t[S]);if("null"==S)return new a(t[S]);if("oid"==S)return new o(t[S]);if("enum"==S)return new l(t[S]);if("utf8str"==S)return new c(t[S]);if("numstr"==S)return new u(t[S]);if("prnstr"==S)return new h(t[S]);if("telstr"==S)return new d(t[S]);if("ia5str"==S)return new p(t[S]);if("utctime"==S)return new g(t[S]);if("gentime"==S)return new f(t[S]);if("seq"==S){for(var w=t[S],C=[],D=0;D<w.length;D++){var T=b(w[D]);C.push(T)}return new m({array:C})}if("set"==S){for(w=t[S],C=[],D=0;D<w.length;D++)T=b(w[D]),C.push(T);return new v({array:C})}if("tag"==S){var x=t[S];if("[object Array]"===Object.prototype.toString.call(x)&&3==x.length){var I=b(x[2]);return new y({tag:x[0],explicit:x[1],obj:I})}var P={};if(void 0!==x.explicit&&(P.explicit=x.explicit),void 0!==x.tag&&(P.tag=x.tag),void 0===x.obj)throw"obj shall be specified for 'tag'.";return P.obj=b(x.obj),new y(P)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},pt.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),r=(e=Math.floor(n/40)+"."+n%40,""),i=2;i<t.length;i+=2){var s=("00000000"+parseInt(t.substr(i,2),16).toString(2)).slice(-8);r+=s.substr(1,7),"0"==s.substr(0,1)&&(e=e+"."+new M(r,2).toString(10),r="")}return e},pt.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new M(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",a=0;a<i;a++)s+="0";for(r=s+r,a=0;a<r.length-1;a+=7){var o=r.substr(a,7);a!=r.length-7&&(o="1"+o),n+=e(parseInt(o,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var a=0;a<i.length;a++)r+=n(i[a]);return r},pt.asn1.ASN1Object=function(){var t="";this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+t.length+",v="+this.hV;var e=this.hV.length/2,n=e.toString(16);if(n.length%2==1&&(n="0"+n),e<128)return n;var r=n.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+n},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},pt.asn1.DERAbstractString=function(t){pt.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},dt.lang.extend(pt.asn1.DERAbstractString,pt.asn1.ASN1Object),pt.asn1.DERAbstractTime=function(t){pt.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,n){var r=this.zeroPadding,i=this.localDateToUTC(t),s=String(i.getFullYear());"utc"==e&&(s=s.substr(2,2));var a=s+r(String(i.getMonth()+1),2)+r(String(i.getDate()),2)+r(String(i.getHours()),2)+r(String(i.getMinutes()),2)+r(String(i.getSeconds()),2);if(!0===n){var o=i.getMilliseconds();if(0!=o){var l=r(String(o),3);a=a+"."+(l=l.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(t)},this.setByDateValue=function(t,e,n,r,i,s){var a=new Date(Date.UTC(t,e-1,n,r,i,s,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},dt.lang.extend(pt.asn1.DERAbstractTime,pt.asn1.ASN1Object),pt.asn1.DERAbstractStructured=function(t){pt.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},dt.lang.extend(pt.asn1.DERAbstractStructured,pt.asn1.ASN1Object),pt.asn1.DERBoolean=function(){pt.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},dt.lang.extend(pt.asn1.DERBoolean,pt.asn1.ASN1Object),pt.asn1.DERInteger=function(t){pt.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=pt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new M(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},dt.lang.extend(pt.asn1.DERInteger,pt.asn1.ASN1Object),pt.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=pt.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}pt.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var i=t.substr(n,8),s=parseInt(i,2).toString(16);1==s.length&&(s="0"+s),r+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},dt.lang.extend(pt.asn1.DERBitString,pt.asn1.ASN1Object),pt.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=pt.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}pt.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},dt.lang.extend(pt.asn1.DEROctetString,pt.asn1.DERAbstractString),pt.asn1.DERNull=function(){pt.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},dt.lang.extend(pt.asn1.DERNull,pt.asn1.ASN1Object),pt.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new M(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",a=0;a<i;a++)s+="0";for(r=s+r,a=0;a<r.length-1;a+=7){var o=r.substr(a,7);a!=r.length-7&&(o="1"+o),n+=e(parseInt(o,2))}return n};pt.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var a=0;a<i.length;a++)r+=n(i[a]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var e=pt.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},dt.lang.extend(pt.asn1.DERObjectIdentifier,pt.asn1.ASN1Object),pt.asn1.DEREnumerated=function(t){pt.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=pt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new M(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},dt.lang.extend(pt.asn1.DEREnumerated,pt.asn1.ASN1Object),pt.asn1.DERUTF8String=function(t){pt.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},dt.lang.extend(pt.asn1.DERUTF8String,pt.asn1.DERAbstractString),pt.asn1.DERNumericString=function(t){pt.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},dt.lang.extend(pt.asn1.DERNumericString,pt.asn1.DERAbstractString),pt.asn1.DERPrintableString=function(t){pt.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},dt.lang.extend(pt.asn1.DERPrintableString,pt.asn1.DERAbstractString),pt.asn1.DERTeletexString=function(t){pt.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},dt.lang.extend(pt.asn1.DERTeletexString,pt.asn1.DERAbstractString),pt.asn1.DERIA5String=function(t){pt.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},dt.lang.extend(pt.asn1.DERIA5String,pt.asn1.DERAbstractString),pt.asn1.DERUTCTime=function(t){pt.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},dt.lang.extend(pt.asn1.DERUTCTime,pt.asn1.DERAbstractTime),pt.asn1.DERGeneralizedTime=function(t){pt.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},dt.lang.extend(pt.asn1.DERGeneralizedTime,pt.asn1.DERAbstractTime),pt.asn1.DERSequence=function(t){pt.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++)t+=this.asn1Array[e].getEncodedHex();return this.hV=t,this.hV}},dt.lang.extend(pt.asn1.DERSequence,pt.asn1.DERAbstractStructured),pt.asn1.DERSet=function(t){pt.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},dt.lang.extend(pt.asn1.DERSet,pt.asn1.DERAbstractStructured),pt.asn1.DERTaggedObject=function(t){pt.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},dt.lang.extend(pt.asn1.DERTaggedObject,pt.asn1.ASN1Object);var gt=function(t){function e(n){var r=t.call(this)||this;return n&&("string"==typeof n?r.parseKey(n):(e.hasPrivateKeyProperty(n)||e.hasPublicKeyProperty(n))&&r.parsePropertiesFrom(n)),r}return f(e,t),e.prototype.parseKey=function(t){try{var e=0,n=0,r=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(t)?v.decode(t):y.unarmor(t),i=I.decode(r);if(3===i.sub.length&&(i=i.sub[2].sub[0]),9===i.sub.length){e=i.sub[1].getHexStringValue(),this.n=_(e,16),n=i.sub[2].getHexStringValue(),this.e=parseInt(n,16);var s=i.sub[3].getHexStringValue();this.d=_(s,16);var a=i.sub[4].getHexStringValue();this.p=_(a,16);var o=i.sub[5].getHexStringValue();this.q=_(o,16);var l=i.sub[6].getHexStringValue();this.dmp1=_(l,16);var c=i.sub[7].getHexStringValue();this.dmq1=_(c,16);var u=i.sub[8].getHexStringValue();this.coeff=_(u,16)}else{if(2!==i.sub.length)return!1;var h=i.sub[1].sub[0];e=h.sub[0].getHexStringValue(),this.n=_(e,16),n=h.sub[1].getHexStringValue(),this.e=parseInt(n,16)}return!0}catch(t){return!1}},e.prototype.getPrivateBaseKey=function(){var t={array:[new pt.asn1.DERInteger({int:0}),new pt.asn1.DERInteger({bigint:this.n}),new pt.asn1.DERInteger({int:this.e}),new pt.asn1.DERInteger({bigint:this.d}),new pt.asn1.DERInteger({bigint:this.p}),new pt.asn1.DERInteger({bigint:this.q}),new pt.asn1.DERInteger({bigint:this.dmp1}),new pt.asn1.DERInteger({bigint:this.dmq1}),new pt.asn1.DERInteger({bigint:this.coeff})]};return new pt.asn1.DERSequence(t).getEncodedHex()},e.prototype.getPrivateBaseKeyB64=function(){return h(this.getPrivateBaseKey())},e.prototype.getPublicBaseKey=function(){var t=new pt.asn1.DERSequence({array:[new pt.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new pt.asn1.DERNull]}),e=new pt.asn1.DERSequence({array:[new pt.asn1.DERInteger({bigint:this.n}),new pt.asn1.DERInteger({int:this.e})]}),n=new pt.asn1.DERBitString({hex:"00"+e.getEncodedHex()});return new pt.asn1.DERSequence({array:[t,n]}).getEncodedHex()},e.prototype.getPublicBaseKeyB64=function(){return h(this.getPublicBaseKey())},e.wordwrap=function(t,e){if(!t)return t;var n="(.{1,"+(e=e||64)+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(n,"g")).join("\n")},e.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=e.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},e.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=e.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},e.hasPublicKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")},e.hasPrivateKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},e.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)},e}(ot),ft=function(){function t(t){t=t||{},this.default_key_size=parseInt(t.default_key_size,10)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null}return t.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new gt(t)},t.prototype.setPrivateKey=function(t){this.setKey(t)},t.prototype.setPublicKey=function(t){this.setKey(t)},t.prototype.decrypt=function(t){try{return this.getKey().decrypt(d(t))}catch(t){return!1}},t.prototype.encrypt=function(t){try{return h(this.getKey().encrypt(t))}catch(t){return!1}},t.prototype.sign=function(t,e,n){try{return h(this.getKey().sign(t,e,n))}catch(t){return!1}},t.prototype.verify=function(t,e,n){try{return this.getKey().verify(t,d(e),n)}catch(t){return!1}},t.prototype.getKey=function(t){if(!this.key){if(this.key=new gt,t&&"[object Function]"==={}.toString.call(t))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},t.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},t.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},t.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},t.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.version="3.0.0-rc.1",t}();window.JSEncrypt=ft,t.JSEncrypt=ft,t.default=ft,Object.defineProperty(t,"__esModule",{value:!0})}(e)})));class ot{encrypt(t,e){let n=new at;return n.setPublicKey(t),n.encrypt(e)}}class lt extends n{}class ct extends n{}class ut extends w{render(t={}){return`${this.response.data.body}`}}class ht extends t{constructor(t){super(t)}}class dt extends n{constructor(t,e={}){super(t,e),this.resolvedModal=null,this.resolvedParameters={}}getResolvedModal(){return this.resolvedModal}setResolvedModal(t){this.resolvedModal=t}}class pt extends e{constructor(t){super(t)}getNextUrl(){return void 0===this.data.nextUrl?null:this.data.nextUrl}}class gt extends e{constructor(t){super(t)}getTdsData(){return void 0===this.data.threeDSMethodData?null:this.data.threeDSMethodData}getTdsUrl(){return void 0===this.data.threeDSMethodURL?null:this.data.threeDSMethodURL}}class ft{createResponse(t){if(void 0!==t.errorMessage)return new m(t);if(void 0!==t.nextAction)switch(t.nextAction){case"error":case"submitToMpi":case"retryChallenge":case"promptForMpi":return new m(t);case"redirectToShop":case"paid":return new pt(t);case"challenged":return new D(t);case"tdsMethod":return new gt(t)}throw new Error("Unable to determine type for received response")}}class mt{constructor(t){this.baseUrl=void 0===t?window.location.href:t}ensureAbsoluteUrl(t){return void 0===t?null:(0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=new URL(t,this.baseUrl).href),t)}}class vt extends h{static onPaymentCompleteEvent(t){let e=new dt(new ht({body:"<p>Your payment was successfully received!</p>"}));u.getInstance().dispatch(e,c.onResolveModalEvent);let n=new nt(e.getResolvedModal(),e.getParameters());u.getInstance().dispatch(n,c.onModalOpenEvent);let r=t.getParameter("paymentCompleteUrl"),i=new mt;return t.setParameter("paymentCompleteUrl",i.ensureAbsoluteUrl(r)),vt.handleRedirection(t,vt.createReturnUrl(t))}static onPaymentRequiresChallengeEvent(t){let e=new dt(t.subject);u.getInstance().dispatch(e,c.onResolveModalEvent);let n=new nt(e.getResolvedModal(),e.getParameters());u.getInstance().dispatch(n,c.onModalOpenEvent)}static onPaymentRequiresTdsMethodEvent(t){let e=a.getInstance().getElementFromReference(i.tdsMethodPlaceholderId),n=t.getSubject(),r='<html><head></head><body><form method="POST" action="'+n.getTdsUrl()+'"><input name="threeDSMethodData" value="'+n.getTdsData()+'" /></form><script type="text/javascript">(function(){ document.querySelector("form").submit() })();<\/script></body></html>',s='<iframe id="tds-method-iframe" src="data:text/html;charset=utf-8,'+encodeURI(r)+'"></iframe>',o=(new DOMParser).parseFromString(s,"text/html");e.innerHTML="",e.appendChild(o.body.firstChild)}static onPaymentAuthenticateEvent(t){u.getInstance().dispatch(new b(t,{state:{isAuthenticatingTds:!0}}),c.onStateChangeEvent);let n=a.getInstance(),i=n.getCurrentState(),s=t.getParameter("encryptedForm"),o=n.getConfig(),l=t.getParameter("poller"),h=new FormData;h.set("pay_encrypted_data",i.payload),h.set("transaction_id",i.transactionId),h.set("threeds_transaction_id",i.threeDSTransactionId),fetch(o.authentication_url,{method:"POST",cache:"no-cache",redirect:"follow",body:h}).then((t=>{if(200!==t.status)throw Error("Unexpected status code returned");return t.json().catch((()=>{throw new Error("Invalid JSON returned.")}))})).then((t=>{let e=(new ft).createResponse(t);if(!e)throw new Error("Invalid response");return e})).then((t=>{t instanceof e?(t instanceof pt&&l.clear(),u.getInstance().dispatch(new r(t,{encryptedForm:s,poller:l,config:o}),c.onActionableResponseEvent)):l.clear()})).catch((t=>{l.clear()})),u.getInstance().dispatch(new b(t,{state:{isAuthenticatingTds:!1}}),c.onStateChangeEvent)}static onPaymentAuthorizeEvent(t){let n=a.getInstance(),i=t.getParameter("pollingEvent"),s=i.getParameter("encryptedForm"),o=i.getParameter("config"),l=i.getParameter("poller"),h=new FormData;h.set("pay_encrypted_data",n.getCurrentState().payload),h.set("transaction_id",n.getCurrentState().transactionId),h.set("threeds_transaction_id",n.getCurrentState().threeDSTransactionId),u.getInstance().dispatch(new S(null),c.onModalCloseEvent),u.getInstance().dispatch(new b(null,{state:{loading:!0,formSubmitted:!0}}),c.onStateChangeEvent),fetch(o.authorization_url,{method:"POST",cache:"no-cache",redirect:"follow",body:h}).then((t=>{if(200!==t.status)throw Error("Unexpected status code returned");return t.json().catch((()=>{throw new Error("Invalid JSON returned.")}))})).then((t=>{let e=(new ft).createResponse(t);if(!e)throw new Error("Invalid response");return e})).then((t=>{t instanceof e?(u.getInstance().dispatch(new r(t,{encryptedForm:s,poller:l,config:o}),c.onActionableResponseEvent),u.getInstance().dispatch(new b(null,{state:{loading:!1,formSubmitted:!1}}),c.onStateChangeEvent)):l.clear()})).catch((t=>{l.clear()}))}static onPaymentCanceledEvent(t){u.getInstance().dispatch(new b(t.getSubject(),{state:{loading:!1,formSubmitted:!1}}),c.onStateChangeEvent),u.getInstance().dispatch(new S(t),c.onModalCloseEvent)}static onPaymentFailedEvent(t){if(t.subject instanceof m){let e=t.subject,n=a.getInstance(),r=[];switch(e.getErrorCode()){case 2201:case 2202:case 2203:r.push(n.getElementFromReference(i.creditCardNumber)),r.push(n.getElementFromReference(i.creditCardCvv)),r.push(n.getElementFromReference(i.creditCardExpirationMonth)),r.push(n.getElementFromReference(i.creditCardExpirationYear));break;case 2801:r.push(n.getElementFromReference(i.creditCardCvv));break;case 2802:r.push(n.getElementFromReference(i.creditCardExpirationMonth)),r.push(n.getElementFromReference(i.creditCardExpirationYear))}r.forEach((function(t){t.setAttribute("data-validation","invalid")}))}let e=new dt(t.subject);u.getInstance().dispatch(e,c.onResolveModalEvent);let n=new nt(e.getResolvedModal(),e.getParameters());u.getInstance().dispatch(new b(t.getSubject(),{state:{loading:!1,formSubmitted:!1}}),c.onStateChangeEvent),u.getInstance().dispatch(n,c.onModalOpenEvent)}static onSubmitDataEvent(t){let e=a.getInstance();if(!e.isChallengeRetry()||!e.isChallengeRetryValid())return;let n=e.getCurrentState();t.setParameter("form_action",t.getParameter("authorization_url")),t.getSubject().set("transaction_id",n.transactionId),t.getSubject().set("threeds_transaction_id",n.threeDSTransactionId)}static createReturnUrl(t){let e=new URL(t.parameters.paymentCompleteUrl),n=t.getParameter("urlParameters",{});try{Object.entries(n).forEach((([t,n])=>{e.searchParams.set(t,n)}))}catch(t){}return e.toString()}static handleRedirection(t,e){if(t.getParameter("redirection_enabled")){let n=e;setTimeout((function(){let e=null!==t.getParameter("redirection_url")?t.getParameter("redirection_url"):n;window.location.replace(e)}),t.getParameter("redirection_timeout"))}}}class yt{constructor(t,e=1500){this.eventDispatcher=t,this.interval=null,this.intervalSeconds=e}poll(t,e){this.clear(),this.interval=setInterval(e,this.intervalSeconds,t),this.eventDispatcher.dispatch(new b(this,{state:{isPolling:!0}}),c.onStateChangeEvent)}clear(){null!=this.interval&&(clearInterval(this.interval),this.eventDispatcher.dispatch(new b(this,{state:{isPolling:!1}}),c.onStateChangeEvent))}getInterval(){return this.interval}hasTimeout(){return null!=this.interval}}class bt{static get success(){return 100}static get informational(){return 80}static get authenticationStarted(){return 30}static get pending(){return 10}static get failed(){return-10}static get canceled(){return-5}}class Et extends h{constructor(t){super(),this.poller=t}onPollingResponse(t){let e=t.subject;try{e.getTransactionStatusCode()||this.poller.clear();let n=e.getTransactionStatusCode(),r=a.getInstance().getCurrentState();switch(n>bt.pending&&n<bt.authenticationStarted&&!1===r.isAuthenticatingTds&&u.getInstance().dispatch(t,c.onPaymentAuthenticateEvent),n){case bt.success:this.poller.clear(),u.getInstance().dispatch(new lt(e,{pollingEvent:t}),c.onPaymentAuthorizeEvent);break;case bt.failed:this.poller.clear(),u.getInstance().dispatch(new v(e),c.onPaymentFailedEvent);break;case bt.canceled:this.poller.clear(),u.getInstance().dispatch(new ct(e),c.onPaymentCanceledEvent)}}catch(t){throw this.poller.clear(),t}}onStopPolling(t){t instanceof S&&t.getSubject()instanceof T&&!t.hasParameter("manual")||this.poller.clear()}}class St extends h{static onResolveModal(t){let e=t.subject,n=null;if(e instanceof f&&e.getTransactionStatusCode()===bt.success&&(n=new C(e)),e instanceof D&&e.isIFrameChallenge()&&(n=new T(e)),e instanceof m&&(n=new q(e)),e instanceof ht&&(n=new ut(e)),!(n||e instanceof gt))throw new Error("Could not resolve modal");t.setResolvedModal(n)}}class wt extends n{}class Ct extends h{static onResponseEvent(t){let e=new ft;t.setParameter("response",e.createResponse(t.subject));let n=a.getInstance().getElementFromReference(i.form);u.getInstance().dispatch(new b(n,{validation:null,state:{loading:!1}}),c.onStateChangeEvent)}}class Dt extends h{static onResponseEvent(t){t.subject=t.subject.json()}}class Tt extends h{static onStateChangeEvent(t){let e=a.getInstance();if("state"in t.parameters){e.updateState(t.parameters.state);let n={inputComplete:Tt.inputComplete(e),formReadyForSubmission:Tt.readyForSubmission(e)};e.updateState(n)}}static onResponseFactoryEvent(t){if(!(t instanceof wt))return;let e=t.hasParameter("response")?t.getParameter("response"):null;if(!e)throw Error("Unable to update state, no response given.");e.getTransactionId()&&e.getThreeDSTransactionId()&&Tt.onStateChangeEvent(new b(t,{state:{transactionId:e.getTransactionId(),threeDSTransactionId:e.getThreeDSTransactionId()}}))}static onSubmitDataEvent(t){let e=t.getSubject();Tt.onStateChangeEvent(new b(t,{state:{payload:e.get("pay_encrypted_data")}}))}static onPaymentCompleteEvent(t){Tt.onStateChangeEvent(new b(t,{validation:null,state:{loading:!1}}))}static onPaymentFailedEvent(t){Tt.onStateChangeEvent(new b(t,{validation:null,state:{loading:!1}}))}static readyForSubmission(t){return Tt.inputComplete(t)}static inputComplete(t){return t.getStateParameter("cardHolderInputComplete")&&t.getStateParameter("cardNumberInputComplete")&&t.getStateParameter("cardCvvInputComplete")&&t.getStateParameter("cardExpiryMonthInputComplete")&&t.getStateParameter("cardExpiryYearInputComplete")}}class xt extends n{}var It={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[624,626],[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[622019,622999],[62207,62209],[622126,622925],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,504174],[504176,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}},Pt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function(t){return t?JSON.parse(JSON.stringify(t)):null}}));it(Pt),Pt.clone;var Rt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.matches=void 0,e.matches=function(t,e){return Array.isArray(e)?function(t,e,n){var r=String(e).length,i=t.substr(0,r),s=parseInt(i,10);return e=parseInt(String(e).substr(0,i.length),10),n=parseInt(String(n).substr(0,i.length),10),s>=e&&s<=n}(t,e[0],e[1]):function(t,e){return(e=String(e)).substring(0,t.length)===t.substring(0,e.length)}(t,e)}}));it(Rt),Rt.matches;var At=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.addMatchingCardsToResults=void 0,e.addMatchingCardsToResults=function(t,e,n){var r,i;for(r=0;r<e.patterns.length;r++){var s=e.patterns[r];if(Rt.matches(t,s)){var a=Pt.clone(e);i=Array.isArray(s)?String(s[0]).length:String(s).length,t.length>=i&&(a.matchStrength=i),n.push(a);break}}}}));it(At),At.addMatchingCardsToResults;var Mt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isValidInputType=void 0,e.isValidInputType=function(t){return"string"==typeof t||t instanceof String}}));it(Mt),Mt.isValidInputType;var Ot=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.findBestMatch=void 0,e.findBestMatch=function(t){return function(t){var e=t.filter((function(t){return t.matchStrength})).length;return e>0&&e===t.length}(t)?t.reduce((function(t,e){return t?Number(t.matchStrength)<Number(e.matchStrength)?e:t:e})):null}}));it(Ot),Ot.findBestMatch;var Bt=rt&&rt.__assign||function(){return(Bt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Lt={},Vt={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},Ft=[Vt.VISA,Vt.MASTERCARD,Vt.AMERICAN_EXPRESS,Vt.DINERS_CLUB,Vt.DISCOVER,Vt.JCB,Vt.UNIONPAY,Vt.MAESTRO,Vt.ELO,Vt.MIR,Vt.HIPER,Vt.HIPERCARD],_t=Pt.clone(Ft);function kt(t){return Lt[t]||It[t]}function Nt(t,e){void 0===e&&(e=!1);var n=_t.indexOf(t);if(!e&&-1===n)throw new Error('"'+t+'" is not a supported card type.');return n}function jt(t){var e=[];if(!Mt.isValidInputType(t))return e;if(0===t.length)return _t.map((function(t){return Pt.clone(kt(t))}));_t.forEach((function(n){var r=kt(n);At.addMatchingCardsToResults(t,r,e)}));var n=Ot.findBestMatch(e);return n?[n]:e}jt.getTypeInfo=function(t){return Pt.clone(kt(t))},jt.removeCard=function(t){var e=Nt(t);_t.splice(e,1)},jt.addCard=function(t){var e=Nt(t.type,!0);Lt[t.type]=t,-1===e&&_t.push(t.type)},jt.updateCard=function(t,e){var n=Lt[t]||It[t];if(!n)throw new Error('"'+t+"\" is not a recognized type. Use `addCard` instead.'");if(e.type&&n.type!==e.type)throw new Error("Cannot overwrite type parameter.");var r=Pt.clone(n);r=Bt(Bt({},r),e),Lt[r.type]=r},jt.changeOrder=function(t,e){var n=Nt(t);_t.splice(n,1),_t.splice(e,0,t)},jt.resetModifications=function(){_t=Pt.clone(Ft),Lt={}},jt.types=Vt;var Ut=jt,Ht=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.cardholderName=void 0;var n=/^[\d\s-]*$/;function r(t,e){return{isValid:t,isPotentiallyValid:e}}e.cardholderName=function(t){return"string"!=typeof t?r(!1,!1):0===t.length?r(!1,!0):t.length>255?r(!1,!1):n.test(t)?r(!1,!0):r(!0,!0)}}));it(Ht),Ht.cardholderName;var qt=function(t){for(var e,n=0,r=!1,i=t.length-1;i>=0;)e=parseInt(t.charAt(i),10),r&&(e*=2)>9&&(e=e%10+1),r=!r,n+=e,i--;return n%10==0},Kt=st((function(t,e){function n(t,e,n){return{card:t,isPotentiallyValid:e,isValid:n}}Object.defineProperty(e,"__esModule",{value:!0}),e.cardNumber=void 0,e.cardNumber=function(t,e){var r,i;if(void 0===e&&(e={}),"string"!=typeof t&&"number"!=typeof t)return n(null,!1,!1);var s=String(t).replace(/-|\s/g,"");if(!/^\d*$/.test(s))return n(null,!1,!1);var a=Ut(s);if(0===a.length)return n(null,!1,!1);if(1!==a.length)return n(null,!0,!1);var o=a[0];if(e.maxLength&&s.length>e.maxLength)return n(o,!1,!1);r=o.type===Ut.types.UNIONPAY&&!0!==e.luhnValidateUnionPay||qt(s),i=Math.max.apply(null,o.lengths),e.maxLength&&(i=Math.min(e.maxLength,i));for(var l=0;l<o.lengths.length;l++)if(o.lengths[l]===s.length)return n(o,s.length<i||r,r);return n(o,s.length<i,!1)}}));it(Kt),Kt.cardNumber;var zt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.expirationYear=void 0;function n(t,e,n){return{isValid:t,isPotentiallyValid:e,isCurrentYear:n||!1}}e.expirationYear=function(t,e){var r;if(void 0===e&&(e=19),"string"!=typeof t)return n(!1,!1);if(""===t.replace(/\s/g,""))return n(!1,!0);if(!/^\d*$/.test(t))return n(!1,!1);var i=t.length;if(i<2)return n(!1,!0);var s=(new Date).getFullYear();if(3===i)return n(!1,t.slice(0,2)===String(s).slice(0,2));if(i>4)return n(!1,!1);var a=parseInt(t,10),o=Number(String(s).substr(2,2)),l=!1;return 2===i?(r=o===a,l=a>=o&&a<=o+e):4===i&&(r=s===a,l=a>=s&&a<=s+e),n(l,l,r)}}));it(zt),zt.expirationYear;var Yt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isArray=void 0,e.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}));it(Yt),Yt.isArray;var Zt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.parseDate=void 0,e.parseDate=function(t){var e;if(/^\d{4}-\d{1,2}$/.test(t)?e=t.split("-").reverse():/\//.test(t)?e=t.split(/\s*\/\s*/g):/\s/.test(t)&&(e=t.split(/ +/g)),Yt.isArray(e))return{month:e[0]||"",year:e.slice(1).join()};var n,r,i,s=(n=t,0===(i=Number(n[0]))?2:i>1||1===i&&Number(n[1])>2?1:1===i?(r=n.substr(1),zt.expirationYear(r).isPotentiallyValid?1:2):5===n.length?1:n.length>5?2:1),a=t.substr(0,s);return{month:a,year:t.substr(a.length)}}}));it(Zt),Zt.parseDate;var $t=st((function(t,e){function n(t,e,n){return{isValid:t,isPotentiallyValid:e,isValidForThisYear:n||!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.expirationMonth=void 0,e.expirationMonth=function(t){var e=(new Date).getMonth()+1;if("string"!=typeof t)return n(!1,!1);if(""===t.replace(/\s/g,"")||"0"===t)return n(!1,!0);if(!/^\d*$/.test(t))return n(!1,!1);var r=parseInt(t,10);if(isNaN(Number(t)))return n(!1,!1);var i=r>0&&r<13;return n(i,i,i&&r>=e)}}));it($t),$t.expirationMonth;var Jt=st((function(t,e){var n=rt&&rt.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return{isValid:t,isPotentiallyValid:e,month:n,year:r}}Object.defineProperty(e,"__esModule",{value:!0}),e.expirationDate=void 0,e.expirationDate=function(t,e){var i;if("string"==typeof t)t=t.replace(/^(\d\d) (\d\d(\d\d)?)$/,"$1/$2"),i=Zt.parseDate(String(t));else{if(null===t||"object"!=typeof t)return r(!1,!1,null,null);var s=n({},t);i={month:String(s.month),year:String(s.year)}}var a=$t.expirationMonth(i.month),o=zt.expirationYear(i.year,e);if(a.isValid){if(o.isCurrentYear){var l=a.isValidForThisYear;return r(l,l,i.month,i.year)}if(o.isValid)return r(!0,!0,i.month,i.year)}return a.isPotentiallyValid&&o.isPotentiallyValid?r(!1,!0,null,null):r(!1,!1,null,null)}}));it(Jt),Jt.expirationDate;var Gt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.cvv=void 0;function n(t,e){return{isValid:t,isPotentiallyValid:e}}e.cvv=function(t,e){return void 0===e&&(e=3),e=e instanceof Array?e:[e],"string"!=typeof t?n(!1,!1):/^\d*$/.test(t)?function(t,e){for(var n=0;n<t.length;n++)if(e===t[n])return!0;return!1}(e,t.length)?n(!0,!0):t.length<Math.min.apply(null,e)?n(!1,!0):t.length>function(t){for(var e=3,n=0;n<t.length;n++)e=t[n]>e?t[n]:e;return e}(e)?n(!1,!1):n(!0,!0):n(!1,!1)}}));it(Gt),Gt.cvv;var Wt=st((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.postalCode=void 0;function n(t,e){return{isValid:t,isPotentiallyValid:e}}e.postalCode=function(t,e){void 0===e&&(e={});var r=e.minLength||3;return"string"!=typeof t?n(!1,!1):t.length<r?n(!1,!0):n(!0,!0)}}));it(Wt),Wt.postalCode;var Qt=it(st((function(t){var e=rt&&rt.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),n=rt&&rt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r={creditCardType:(rt&&rt.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&e(r,t,i);return n(r,t),r})(Ut),cardholderName:Ht.cardholderName,number:Kt.cardNumber,expirationDate:Jt.expirationDate,expirationMonth:$t.expirationMonth,expirationYear:zt.expirationYear,cvv:Gt.cvv,postalCode:Wt.postalCode};t.exports=r})));class Xt{constructor(t){this.urlHelper=new mt,void 0!==t.public_keys&&(t.public_keys=$.fromJson(t.public_keys)),this.config=Object.assign({},{debug:!1,refresh_url:null,status_url:null,authentication_url:null,authorization_url:null,post_url:null,payment_complete_url:null,form_input_payload_name:"pay_encrypted_data",form_selector:"data-pay-encrypt-form",field_selector:"data-pay-encrypt-field",field_value_reader:"name",public_keys:[],language:"NL",merchant_identifier:null,html5_enhanced_validation:!0,default_cvv_label:"CVC",default_card_number_length:19,bind:{submit:!0},icons:{creditcard:{default:"img/creditcard/cc-front.svg",alipay:"img/creditcard/cc-alipay.svg","american-express":"img/creditcard/cc-amex.svg","diners-club":"img/creditcard/cc-diners-club.svg",discover:"img/creditcard/cc-discover.svg",elo:"img/creditcard/cc-elo.svg",hiper:"img/creditcard/cc-hiper.svg",hipercard:"img/creditcard/cc-hipercard.svg",jcb:"img/creditcard/cc-jcb.svg",maestro:"img/creditcard/cc-maestro.svg",mastercard:"img/creditcard/cc-mastercard.svg",mir:"img/creditcard/cc-mir.svg",unionpay:"img/creditcard/cc-unionpay.svg",visa:"img/creditcard/cc-visa.svg"}}},t),this.config.refresh_url=this.urlHelper.ensureAbsoluteUrl(this.config.refresh_url),this.config.status_url=this.urlHelper.ensureAbsoluteUrl(this.config.status_url),this.config.authentication_url=this.urlHelper.ensureAbsoluteUrl(this.config.authentication_url),this.config.authorization_url=this.urlHelper.ensureAbsoluteUrl(this.config.authorization_url),this.config.post_url=this.urlHelper.ensureAbsoluteUrl(this.config.post_url),this.config.payment_complete_url=this.urlHelper.ensureAbsoluteUrl(this.config.payment_complete_url);for(const[t,e]of Object.entries(this.config.icons.creditcard))this.config.icons.creditcard[t]=this.urlHelper.ensureAbsoluteUrl(e);this.checkSettings(),this.createTdsMethodPlaceHolder(),this.state=a.getInstance(),this.state.setConfig(this.config),this.poller=new yt(this.getEventDispatcher()),this.registerDefaultEventListeners()}getConfig(){return this.config}getPoller(){return this.poller}getEventDispatcher(){return u.getInstance()}init(){let t=this.getElementByReference(i.form);!0===this.config.html5_enhanced_validation&&this.applyAttributesToElementsOfForm(t),this.createPayloadInput(t),this.bindings(),this.triggerEventsWhenFormAlreadyHasInput(),this.registerPaymentCompleteListener(),this.registerErrorListener(),this.debug("Initialization complete.")}bindings(){this.bindCreditCardHolder(),this.bindCreditCardNumberInput(),this.bindCreditCardCvcInput(),this.bindCreditCardExpirationMonth(),this.bindCreditCardExpirationYear(),this.config.bind.submit&&this.bindForm()}checkSettings(){let t=this;["refresh_url","status_url","authentication_url","authorization_url","post_url","payment_complete_url"].forEach((function(e){if(null===t.config[e])throw new Error(`The ${e} config option must be defined.`)}))}handleFormSubmission(n){let i={browserJavaEnabled:navigator.javaEnabled(),browserJavascriptEnabled:!0,browserLanguage:navigator.language,browserColorDepth:screen.colorDepth,browserScreenWidth:screen.width,browserScreenHeight:screen.height,browserTZ:(new Date).getTimezoneOffset()},s=new ot,a=new J(this.config.public_keys,this.config.refresh_url),o=this;const l=this.config.field_selector,h=this.config.field_value_reader,d=this.config.merchant_identifier,p=this.config.language;o.getEventDispatcher().dispatch(new b(n,{validation:null,state:{loading:!0,formSubmitted:!0}}),c.onStateChangeEvent),a.getUnexpiredPublicKey().then((a=>{n.querySelectorAll("["+l+"]").forEach((function(t){let e=t.getAttribute(h);i[e]=t.value}));let g={identifier:a.identifier,merchant_identifier:d,language:p,payment_complete_url:o.config.payment_complete_url,data:s.encrypt(a.getKey(),JSON.stringify(i)).toString()},f=new FormData;f.set("pay_encrypted_data",JSON.stringify(g));let m=this.config.post_url,v=null===m?o.urlHelper.ensureAbsoluteUrl(n.getAttribute("action")):m,y=new xt(f,{form_action:v,authorization_url:o.config.authorization_url});u.getInstance().dispatch(y,c.onSubmitDataEvent),u.getInstance().dispatch(new U("Posting form data.",{url:y.getParameter("form_action"),data:y.getSubject()}),c.onDebugEvent),fetch(y.getParameter("form_action"),{method:"POST",cache:"no-cache",redirect:"follow",body:y.getSubject()}).then(((t,e)=>{if(t.ok)return u.getInstance().dispatch(new U("Received RAW response.",{response:t}),c.onDebugEvent),t;e(Error("Unexpected response from server."))})).then((t=>(u.getInstance().dispatch(new U("Converting RAW response to JSON.",{response:t}),c.onDebugEvent),t.json().catch((()=>{throw new Error("Invalid JSON returned.")}))))).then((e=>{let n=new wt(e);u.getInstance().dispatch(n,c.onResponseFactoryEvent);let r=n.hasParameter("response")&&n.getParameter("response")instanceof t?n.getParameter("response"):null;if(!r)throw new Error("Invalid response");return r})).then((t=>{if(!(t instanceof e))throw new Error("Received non actionable response.");o.getEventDispatcher().dispatch(new r(t,{encryptedForm:this,poller:this.poller,config:this.config}),c.onActionableResponseEvent)})).catch((t=>{throw this.poller.clear(),o.getEventDispatcher().dispatch(new b(n,{validation:null,state:{loading:!1,formSubmitted:!1},exception:t}),c.onStateChangeEvent),t}))})).catch((t=>{throw this.poller.clear(),o.getEventDispatcher().dispatch(new b(n,{validation:null,state:{loading:!1,formSubmitted:!1},exception:t}),c.onStateChangeEvent),t}))}bindForm(){let t=this.getElementByReference(i.form),e=this;t.addEventListener("submit",(function(n){n.preventDefault(),e.handleFormSubmission(t)}))}bindCreditCardHolder(){let t=this;document.addEventListener("input",(function(e){let n=t.getElementByReference(i.creditCardHolder);if(e.target!==n)return;let r=Qt.cardholderName(n.value),s=t.getValidationAttributeValue(r);n.setAttribute("data-validation",s),t.getEventDispatcher().dispatch(new b(n,{validation:n.getAttribute("data-validation"),state:{cardHolderInputComplete:"valid"===s}}),c.onStateChangeEvent)}))}bindCreditCardNumberInput(){let t=this,e="default";document.addEventListener("input",(function(n){let r=t.getElementByReference(i.creditCardNumber);if(n.target!==r)return;let s=t.getElementByReference(i.creditCardCvv),a=t.getElementByReference(i.creditCardCvvLabel),o=r.value,l=Qt.number(o);e=null!==l.card&&null!==l.card.type?l.card.type:"default",t.renderCreditCardImage(t.getElementByReference(i.creditCardImage),e in t.config.icons.creditcard?e:"default");let u=null!==l.card?Math.max(...l.card.lengths):t.config.default_card_number_length,h=(o.match(/\s/g)||[]).length,d=null!==l.card?l.card.code.size:"4",p=t.getValidationAttributeValue(l);r.setAttribute("data-validation",p),r.setAttribute("maxlength",(u+h).toString()),r.setAttribute("minlength",u),t.getEventDispatcher().dispatch(new b(r,{validation:r.getAttribute("data-validation"),state:{cardNumberInputComplete:"valid"===r.getAttribute("data-validation")||"potentially-valid"===r.getAttribute("data-validation")}}),c.onStateChangeEvent),s.setAttribute("minlength",d),s.setAttribute("maxlength",d);let g=s.getAttribute("data-validation");t.getEventDispatcher().dispatch(new b(s,{validation:g,state:{cardCvvInputComplete:"valid"===g&&("valid"===p||"potentially-valid"===p)}}),c.onStateChangeEvent),a.innerHTML=null!==l.card?l.card.code.name:t.config.default_cvv_label})),document.addEventListener("change",(function(e){let n=t.getElementByReference(i.creditCardNumber);e.target===n&&t.getEventDispatcher().dispatch(new b(n,{state:{challengeRetry:!1}}),c.onStateChangeEvent)})),new j('input[name="cardnumber"]',{creditCard:!0,creditCardStrictMode:!0}),this.renderCreditCardImage(t.getElementByReference(i.creditCardImage),e)}bindCreditCardCvcInput(){let t=this;document.addEventListener("input",(function(e){let n=t.getElementByReference(i.creditCardNumber),r=t.getElementByReference(i.creditCardCvv);if(e.target!==r)return;let s=Qt.number(n.value),a=null;a=null!==s.card&&null!==s.card.code?Qt.cvv(r.value,s.card.code.size):Qt.cvv(r.value);let o=t.getValidationAttributeValue(a);r.setAttribute("data-validation",o),t.getEventDispatcher().dispatch(new b(r,{validation:r.getAttribute("data-validation"),state:{cardCvvInputComplete:"valid"===o||"potentially-valid"===o}}),c.onStateChangeEvent)}))}bindCreditCardExpirationMonth(){let t=this;document.addEventListener("change",(function(e){let n=t.getElementByReference(i.creditCardExpirationMonth),r=t.getElementByReference(i.creditCardExpirationYear);e.target===n&&(t.validateMonthYearCombination(),t.getEventDispatcher().dispatch(new b(n,{validation:n.getAttribute("data-validation"),state:{cardExpiryMonthInputComplete:"valid"===n.getAttribute("data-validation"),cardExpiryYearInputComplete:"valid"===r.getAttribute("data-validation")}}),c.onStateChangeEvent))}))}bindCreditCardExpirationYear(t){let e=this;document.addEventListener("change",(function(n){let r=e.getElementByReference(i.creditCardExpirationMonth),s=e.getElementByReference(i.creditCardExpirationYear);n.target===s&&(e.validateMonthYearCombination(t),e.getEventDispatcher().dispatch(new b(s,{validation:s.getAttribute("data-validation"),state:{cardExpiryMonthInputComplete:"valid"===r.getAttribute("data-validation"),cardExpiryYearInputComplete:"valid"===s.getAttribute("data-validation")}}),c.onStateChangeEvent))}))}triggerEventsWhenFormAlreadyHasInput(){[this.getElementByReference(i.creditCardHolder),this.getElementByReference(i.creditCardNumber),this.getElementByReference(i.creditCardCvv),this.getElementByReference(i.creditCardExpirationMonth),this.getElementByReference(i.creditCardExpirationYear)].forEach((function(t){if(t.value){let e=null;switch(t.nodeName.toLowerCase()){case"select":e="change";break;case"input":e="input"}let n=new Event(e,{bubbles:!0});t.dispatchEvent(n)}}))}validateMonthYearCombination(){let t=this.getElementByReference(i.creditCardExpirationMonth),e=this.getElementByReference(i.creditCardExpirationYear),n=Qt.expirationDate({month:t.value,year:e.value});return t.setAttribute("data-validation",this.getValidationAttributeValue(n)),e.setAttribute("data-validation",this.getValidationAttributeValue(n)),n}registerPaymentCompleteListener(){let t=this;window.addEventListener("payment-complete",(function(e){let n=new p(e,{encryptedForm:this,originalEvent:e,paymentCompleteUrl:t.config.payment_complete_url,urlParameters:e.detail});u.getInstance().dispatch(n,c.onPaymentCompleteEvent)}))}registerErrorListener(){let t=this;window.addEventListener("error",(function(e){let n=new m(e.detail),r=new v(n,{encryptedForm:this,originalEvent:e,paymentCompleteUrl:t.config.payment_complete_url,urlParameters:e.detail});u.getInstance().dispatch(r,c.onPaymentFailedEvent)}))}applyAttributesToElementsOfForm(t){let e=this.config.field_selector,n=this.config.field_value_reader;t.querySelectorAll("["+e+"]").forEach((function(t){let e=Xt.getAttributesForField(n,t);Xt.applyAttributesToField(t,e)}))}static applyAttributesToField(t,e){for(let[n,r]of Object.entries(e))"function"==typeof r&&(r=r(t)),null===r||t.hasAttribute(n)||t.setAttribute(n,r)}static getAttributesForField(t,e){let n=e.getAttribute(t),r=Xt.getAttributes();if(void 0===r[n])throw Error("Unknown field: "+e);return Object.assign({},Xt.getDefaultAttributes(),r[n])}getValidationAttributeValue(t){return t.isValid||t.isPotentiallyValid?t.isValid&&t.isPotentiallyValid?"valid":t.isPotentiallyValid?"potentially-valid":null:"invalid"}getElementByReference(t){try{return this.state.getElementFromReference(t)}catch(t){return null}}static getAttributes(){return{cardholder:{},cardnumber:{type:"text",minlength:function(t){return"number"===t.getAttribute("type")?13:null},maxlength:function(t){return"number"===t.getAttribute("type")?16:null},inputmode:"numeric",autocomplete:"cc-number",autocorrect:"off"},cardcvc:{minlength:function(t){return"number"===t.getAttribute("type")?3:null},maxlength:function(t){return"number"===t.getAttribute("type")?4:null},pattern:function(t){return"text"===t.getAttribute("type")||null===t.getAttribute("type")?"[0-9]{3,4}":null},inputmode:"numeric",autocomplete:"cc-csc",autocorrect:"off"},expiry:{pattern:"(20|21)[0-9]{2}-[0-9]{2}",inputmode:"numeric",autocomplete:"cc-exp",autocorrect:"off"},valid_thru_month:{pattern:"(0[1-9]|1[012])",inputmode:"numeric",autocomplete:"cc-exp-month",autocorrect:"off"},valid_thru_year:{pattern:"(20|21)[0-9]{2}",inputmode:"numeric",autocomplete:"cc-exp-year",autocorrect:"off"}}}static getDefaultAttributes(){return{required:"required"}}createPayloadInput(t){let e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",this.config.form_input_payload_name),t.appendChild(e),t}createTdsMethodPlaceHolder(){let t=document.createElement("div");t.setAttribute("style","display:none;height:0px;width:0px;"),t.setAttribute("id",i.tdsMethodPlaceholderId),document.querySelector("body").appendChild(t)}renderCreditCardImage(t,e){null!==t&&t.getAttribute("data-cc-type")!==e&&(t.src=this.config.icons.creditcard[e],t.setAttribute("data-cc-type",e))}debug(t,e={}){!1!==this.config.debug&&this.getEventDispatcher().dispatch(new U(t,e),c.onDebugEvent)}registerDefaultEventListeners(){this.config.debug?this.registerDebugListeners():this.getEventDispatcher().addListener(c.onDebugEvent,(t=>H.onDebugNull(t)),50);let t=new Et(this.poller);this.getEventDispatcher().addListener(c.onPaymentRequiresChallengeEvent,(t=>vt.onPaymentRequiresChallengeEvent(t)),50),this.getEventDispatcher().addListener(c.onPaymentCanceledEvent,(t=>vt.onPaymentCanceledEvent(t)),50),this.getEventDispatcher().addListener(c.onPaymentCompleteEvent,(t=>vt.onPaymentCompleteEvent(t)),50),this.getEventDispatcher().addListener(c.onPaymentCompleteEvent,(t=>Tt.onPaymentCompleteEvent(t)),60),this.getEventDispatcher().addListener(c.onPaymentFailedEvent,(t=>Tt.onPaymentFailedEvent(t)),60),this.getEventDispatcher().addListener(c.onPaymentFailedEvent,(t=>vt.onPaymentFailedEvent(t)),50),this.getEventDispatcher().addListener(c.onResponseEvent,(t=>Dt.onResponseEvent(t)),50),this.getEventDispatcher().addListener(c.onResponseFactoryEvent,(t=>Ct.onResponseEvent(t)),50),this.getEventDispatcher().addListener(c.onResponseFactoryEvent,(t=>Tt.onResponseFactoryEvent(t)),70),this.getEventDispatcher().addListener(c.onStateChangeEvent,(t=>Tt.onStateChangeEvent(t)),50),this.getEventDispatcher().addListener(c.onStateChangeEvent,(t=>Y.onStateChangeEvent(t)),50),this.getEventDispatcher().addListener(c.onStateChangeEvent,(t=>z.onStateChangeEvent(t)),50),this.getEventDispatcher().addListener(c.onModalOpenEvent,(t=>et.onModalOpen(t)),50),this.getEventDispatcher().addListener(c.onModalCloseEvent,(t=>et.onModalClose(t)),50),this.getEventDispatcher().addListener(c.onModalCloseEvent,(e=>t.onStopPolling(e)),50),this.getEventDispatcher().addListener(c.onResolveModalEvent,(t=>St.onResolveModal(t)),50),this.getEventDispatcher().addListener(c.onPollingResponseEvent,(e=>t.onPollingResponse(e)),50),this.getEventDispatcher().addListener(c.onPaymentAuthorizeEvent,(t=>vt.onPaymentAuthorizeEvent(t)),50),this.getEventDispatcher().addListener(c.onActionableResponseEvent,(t=>E.onActionableResponse(t)),50),this.getEventDispatcher().addListener(c.onPaymentRequiresTdsMethodEvent,(t=>vt.onPaymentRequiresTdsMethodEvent(t)),50),this.getEventDispatcher().addListener(c.onPaymentAuthenticateEvent,(t=>vt.onPaymentAuthenticateEvent(t)),50),this.getEventDispatcher().addListener(c.onSubmitDataEvent,(t=>vt.onSubmitDataEvent(t)),50),this.getEventDispatcher().addListener(c.onSubmitDataEvent,(t=>Tt.onSubmitDataEvent(t)),60)}registerDebugListeners(){this.getEventDispatcher().addListener(c.onDebugEvent,(t=>H.onDebugEvent(t)),50),this.getEventDispatcher().addListener(c.onModalCloseEvent,(t=>H.onModalCloseEvent(t)),50),this.getEventDispatcher().addListener(c.onModalOpenEvent,(t=>H.onModalOpenEvent(t)),50),this.getEventDispatcher().addListener(c.onPaymentCompleteEvent,(t=>H.onPaymentCompleteEvent(t)),50),this.getEventDispatcher().addListener(c.onPaymentFailedEvent,(t=>H.onPaymentFailedEvent(t)),50),this.getEventDispatcher().addListener(c.onResponseFactoryEvent,(t=>H.onResponseFactoryEvent(t)),50),this.getEventDispatcher().addListener(c.onRequestEvent,(t=>H.onRequestEvent(t)),50),this.getEventDispatcher().addListener(c.onResponseEvent,(t=>H.onResponseEvent(t)),50),this.getEventDispatcher().addListener(c.onStateChangeEvent,(t=>H.onStateChangeEvent(t)),50)}}export{r as ActionableResponseEvent,C as AuthorizingModal,T as ChallengeModal,U as DebugEvent,s as ElementReferences,i as Elements,Xt as EncryptedForm,q as ErrorModal,u as EventDispatcher,h as EventListener,c as Events,z as FormDisableElementsListener,Y as FormSubmissionListener,n as GenericEvent,S as ModalCloseEvent,et as ModalListener,nt as ModalOpenEvent,lt as PaymentAuthorizationEvent,ct as PaymentCanceledEvent,p as PaymentCompleteEvent,ut as PaymentCompleteModal,v as PaymentFailedEvent,vt as PaymentListener,d as PaymentRequiresChallengeEvent,y as PaymentRequiresTdsMethodEvent,Et as PollingListener,f as PollingResponse,g as PollingResponseEvent,St as ResolveModalListener,wt as ResponseFactoryEvent,Ct as ResponseFactoryListener,Dt as ResponseToJsonListener,a as State,b as StateChangeEvent,Tt as StateChangeListener,bt as ThreeDSTransactionStatus,mt as UrlHelper};
